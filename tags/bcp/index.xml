<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/"><channel><title>Bcp on cdeclog</title><link>https://cdecl.github.io/tags/bcp/</link><description>Recent content in Bcp on cdeclog</description><generator>Hugo -- 0.154.5</generator><language>ko-kr</language><lastBuildDate>Thu, 14 Oct 2021 00:00:00 +0900</lastBuildDate><atom:link href="https://cdecl.github.io/tags/bcp/index.xml" rel="self" type="application/rss+xml"/><item><title>SQL Server, BCP</title><link>https://cdecl.github.io/devops/sqlserver-bcp/</link><pubDate>Thu, 14 Oct 2021 00:00:00 +0900</pubDate><guid>https://cdecl.github.io/devops/sqlserver-bcp/</guid><description>&lt;p&gt;SQL Server 대량 복사 프로그램 유틸리티(&lt;strong&gt;b&lt;/strong&gt; ulk &lt;strong&gt;c&lt;/strong&gt; opy &lt;strong&gt;p&lt;/strong&gt; rogram utility, &lt;code&gt;bcp&lt;/code&gt;)&lt;/p&gt;
&lt;h2 id="bcp"&gt;BCP&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://docs.microsoft.com/ko-kr/sql/tools/bcp-utility"&gt;https://docs.microsoft.com/ko-kr/sql/tools/bcp-utility&lt;/a&gt;{:target=&amp;quot;_blank&amp;quot;}&lt;/li&gt;
&lt;li&gt;SQL Server 의 Bulk 대량 데이터 Export 및 Import 유틸리티&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="설치"&gt;설치&lt;/h3&gt;
&lt;h4 id="windows"&gt;Windows&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;다운로드 : &lt;a href="https://www.microsoft.com/en-us/download/details.aspx?id=53591"&gt;Microsoft® Command Line Utilities 14.0 for SQL Server&lt;/a&gt;{:target=&amp;quot;_blank&amp;quot;}&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="linux"&gt;Linux&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;SQL Server 의 리눅스 지원으로 사용 가능&lt;/li&gt;
&lt;li&gt;&lt;a href="https://docs.microsoft.com/ko-kr/sql/linux/sql-server-linux-setup-tools"&gt;Linux에서 SQL Server 명령줄 도구 sqlcmd 및 bcp 설치&lt;/a&gt;{:target=&amp;quot;_blank&amp;quot;}&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="export-기본"&gt;Export 기본&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;cvs&lt;/code&gt; 파일로 테이블(쿼리 데이터) Export&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-sh" data-lang="sh"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;$ bcp
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;사용법: bcp &lt;span style="color:#ff79c6"&gt;{&lt;/span&gt;dbtable | query&lt;span style="color:#ff79c6"&gt;}&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;{&lt;/span&gt;in | out | queryout | format&lt;span style="color:#ff79c6"&gt;}&lt;/span&gt; 데이터 파일
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#ff79c6"&gt;[&lt;/span&gt;-m 최대 오류 수&lt;span style="color:#ff79c6"&gt;]&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;[&lt;/span&gt;-f 서식 파일&lt;span style="color:#ff79c6"&gt;]&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;[&lt;/span&gt;-e 오류 파일&lt;span style="color:#ff79c6"&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#ff79c6"&gt;[&lt;/span&gt;-F 첫 행&lt;span style="color:#ff79c6"&gt;]&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;[&lt;/span&gt;-L 마지막 행&lt;span style="color:#ff79c6"&gt;]&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;[&lt;/span&gt;-b 일괄 처리 크기&lt;span style="color:#ff79c6"&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#ff79c6"&gt;[&lt;/span&gt;-n 네이티브 유형&lt;span style="color:#ff79c6"&gt;]&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;[&lt;/span&gt;-c 문자 유형&lt;span style="color:#ff79c6"&gt;]&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;[&lt;/span&gt;-w 와이드 문자 유형&lt;span style="color:#ff79c6"&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#ff79c6"&gt;[&lt;/span&gt;-N 비텍스트 네이티브 유지&lt;span style="color:#ff79c6"&gt;]&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;[&lt;/span&gt;-V 파일 형식 버전&lt;span style="color:#ff79c6"&gt;]&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;[&lt;/span&gt;-q 따옴표 붙은 식별자&lt;span style="color:#ff79c6"&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#ff79c6"&gt;[&lt;/span&gt;-C 코드 페이지 지정자&lt;span style="color:#ff79c6"&gt;]&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;[&lt;/span&gt;-t 필드 종결자&lt;span style="color:#ff79c6"&gt;]&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;[&lt;/span&gt;-r 행 종결자&lt;span style="color:#ff79c6"&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#ff79c6"&gt;[&lt;/span&gt;-i 입력 파일&lt;span style="color:#ff79c6"&gt;]&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;[&lt;/span&gt;-o 출력 파일&lt;span style="color:#ff79c6"&gt;]&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;[&lt;/span&gt;-a 패킷 크기&lt;span style="color:#ff79c6"&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#ff79c6"&gt;[&lt;/span&gt;-S 서버 이름&lt;span style="color:#ff79c6"&gt;]&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;[&lt;/span&gt;-U 사용자 이름&lt;span style="color:#ff79c6"&gt;]&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;[&lt;/span&gt;-P 암호&lt;span style="color:#ff79c6"&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#ff79c6"&gt;[&lt;/span&gt;-T 트러스트된 연결&lt;span style="color:#ff79c6"&gt;]&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;[&lt;/span&gt;-v 버전&lt;span style="color:#ff79c6"&gt;]&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;[&lt;/span&gt;-R 국가별 설정 사용&lt;span style="color:#ff79c6"&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#ff79c6"&gt;[&lt;/span&gt;-k Null 값 유지&lt;span style="color:#ff79c6"&gt;]&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;[&lt;/span&gt;-E ID 값 유지&lt;span style="color:#ff79c6"&gt;][&lt;/span&gt;-G Azure Active Directory 인증&lt;span style="color:#ff79c6"&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#ff79c6"&gt;[&lt;/span&gt;-h &lt;span style="color:#f1fa8c"&gt;&amp;#34;힌트 로드&amp;#34;&lt;/span&gt;&lt;span style="color:#ff79c6"&gt;]&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;[&lt;/span&gt;-x xml 서식 파일 생성&lt;span style="color:#ff79c6"&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#ff79c6"&gt;[&lt;/span&gt;-d 데이터베이스 이름&lt;span style="color:#ff79c6"&gt;]&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;[&lt;/span&gt;-K 애플리케이션 의도&lt;span style="color:#ff79c6"&gt;]&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;[&lt;/span&gt;-l 로그인 제한 시간&lt;span style="color:#ff79c6"&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id="export-csv"&gt;Export &lt;code&gt;csv&lt;/code&gt;&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-sh" data-lang="sh"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;$ bcp &lt;span style="color:#f1fa8c"&gt;&amp;#34;SELECT * FROM dbname.dbo.tablename&amp;#34;&lt;/span&gt; queryout tablename.csv -c -t &lt;span style="color:#f1fa8c"&gt;&amp;#34;,&amp;#34;&lt;/span&gt; -r &lt;span style="color:#f1fa8c"&gt;&amp;#34;\n&amp;#34;&lt;/span&gt; -S &amp;lt;SERVER&amp;gt; -U &amp;lt;USER&amp;gt; -P &amp;lt;PASSWD&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h5 id="테이블-지정-export--out"&gt;테이블 지정 Export : &lt;code&gt;out&lt;/code&gt;&lt;/h5&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-sh" data-lang="sh"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;$ bcp &lt;span style="color:#f1fa8c"&gt;&amp;#34;dbname.dbo.tablename&amp;#34;&lt;/span&gt; out output.csv ...
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h5 id="쿼리-실행-결과-export--queryout"&gt;쿼리 실행 결과 Export : &lt;code&gt;queryout&lt;/code&gt;&lt;/h5&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-sh" data-lang="sh"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;$ bcp &lt;span style="color:#f1fa8c"&gt;&amp;#34;query&amp;#34;&lt;/span&gt; queryout output.csv ...
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h5 id="export-데이터-형식"&gt;Export 데이터 형식&lt;/h5&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;-n&lt;/code&gt; : 네이티브 포맷, SQL Server로 데이터 이전 할때 유용 (종결자 등의 이유로 데이터 이슈 해결)&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-c&lt;/code&gt; : 문자유형, OS의 기본 Charset을 따라감
&lt;ul&gt;
&lt;li&gt;한글 Windows : &lt;code&gt;EUC-KR&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Linux : &lt;code&gt;UTF-8&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-w&lt;/code&gt; : 와이드 문자유형, 유니코드 &lt;code&gt;UTF-16 LE&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="import"&gt;Import&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-sh" data-lang="sh"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;$ bcp &lt;span style="color:#f1fa8c"&gt;&amp;#34;dbname.dbo.tablename&amp;#34;&lt;/span&gt; in input.csv -c -t &lt;span style="color:#f1fa8c"&gt;&amp;#34;,&amp;#34;&lt;/span&gt; -r &lt;span style="color:#f1fa8c"&gt;&amp;#34;\n&amp;#34;&lt;/span&gt; -S &amp;lt;SERVER&amp;gt; -U &amp;lt;USER&amp;gt; -P &amp;lt;PASSWD&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;hr&gt;
&lt;h3 id="특이사항"&gt;특이사항&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;길이가 0인 문자열의 경우 데이터 내에 &lt;code&gt;NULL&lt;/code&gt; 문자를 삽입&lt;/li&gt;
&lt;li&gt;SQL Server의 경우 문제는 없지만, 다른 DB 에 Import 의 경우 &lt;code&gt;NULL&lt;/code&gt; 문자가 들어감&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-sql" data-lang="sql"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#ff79c6"&gt;INSERT&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;INTO&lt;/span&gt; tablename (filed) &lt;span style="color:#ff79c6"&gt;SELECT&lt;/span&gt; &lt;span style="color:#8be9fd;font-style:italic"&gt;CHARACTER&lt;/span&gt;(&lt;span style="color:#bd93f9"&gt;0&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#6272a4"&gt;-- MySQL 5.7
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#ff79c6"&gt;SELECT&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;*&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;FROM&lt;/span&gt; tablename &lt;span style="color:#ff79c6"&gt;WHERE&lt;/span&gt; filed &lt;span style="color:#ff79c6"&gt;=&lt;/span&gt; &lt;span style="color:#f1fa8c"&gt;&amp;#39;&amp;#39;&lt;/span&gt;; &lt;span style="color:#6272a4"&gt;-- Not Working
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#ff79c6"&gt;SELECT&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;*&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;FROM&lt;/span&gt; tablename &lt;span style="color:#ff79c6"&gt;WHERE&lt;/span&gt; ASCII(filed) &lt;span style="color:#ff79c6"&gt;=&lt;/span&gt; &lt;span style="color:#bd93f9"&gt;0&lt;/span&gt;; &lt;span style="color:#6272a4"&gt;-- Working
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#6272a4"&gt;-- MySQL 8
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#ff79c6"&gt;SELECT&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;*&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;FROM&lt;/span&gt; tablename &lt;span style="color:#ff79c6"&gt;WHERE&lt;/span&gt; filed &lt;span style="color:#ff79c6"&gt;=&lt;/span&gt; &lt;span style="color:#f1fa8c"&gt;&amp;#39;&amp;#39;&lt;/span&gt;; &lt;span style="color:#6272a4"&gt;-- Working
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#ff79c6"&gt;SELECT&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;*&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;FROM&lt;/span&gt; tablename &lt;span style="color:#ff79c6"&gt;WHERE&lt;/span&gt; ASCII(filed) &lt;span style="color:#ff79c6"&gt;=&lt;/span&gt; &lt;span style="color:#bd93f9"&gt;0&lt;/span&gt;; &lt;span style="color:#6272a4"&gt;-- Working
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</description></item></channel></rss>