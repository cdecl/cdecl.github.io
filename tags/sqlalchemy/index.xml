<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/"><channel><title>Sqlalchemy on cdeclog</title><link>https://cdecl.github.io/tags/sqlalchemy/</link><description>Recent content in Sqlalchemy on cdeclog</description><generator>Hugo -- 0.155.3</generator><language>ko-kr</language><lastBuildDate>Thu, 12 Aug 2021 00:00:00 +0900</lastBuildDate><atom:link href="https://cdecl.github.io/tags/sqlalchemy/index.xml" rel="self" type="application/rss+xml"/><item><title>SQLAlchemy Query Basic (w/Flask)</title><link>https://cdecl.github.io/dev/sqlalchemy-query-simple/</link><pubDate>Thu, 12 Aug 2021 00:00:00 +0900</pubDate><guid>https://cdecl.github.io/dev/sqlalchemy-query-simple/</guid><description>&lt;p&gt;Flask 에서 SQLAlchemy 사용시 Query 팁&lt;/p&gt;
&lt;h2 id="설정"&gt;설정&lt;/h2&gt;
&lt;h3 id="connection"&gt;Connection&lt;/h3&gt;
&lt;p&gt;기본 DBMS 연결 정보&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"&gt;&lt;code class="language-py" data-lang="py"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#6272a4"&gt;# MySQL&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;app&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;config[&lt;span style="color:#f1fa8c"&gt;&amp;#39;SQLALCHEMY_DATABASE_URI&amp;#39;&lt;/span&gt;] &lt;span style="color:#ff79c6"&gt;=&lt;/span&gt; &lt;span style="color:#f1fa8c"&gt;r&lt;/span&gt;&lt;span style="color:#f1fa8c"&gt;&amp;#39;mysql+pymysql://user:passwd@address:3306/db_name?charset=UTF8MB4&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;db &lt;span style="color:#ff79c6"&gt;=&lt;/span&gt; SQLAlchemy()
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;db&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;init_app(app)
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id="bind-추가"&gt;Bind 추가&lt;/h3&gt;
&lt;p&gt;기본 DBMS 이외, 추가적인 DB 정보 추가&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"&gt;&lt;code class="language-py" data-lang="py"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;app&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;config[&lt;span style="color:#f1fa8c"&gt;&amp;#39;SQLALCHEMY_BINDS&amp;#39;&lt;/span&gt;] &lt;span style="color:#ff79c6"&gt;=&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#f1fa8c"&gt;&amp;#39;dbms1&amp;#39;&lt;/span&gt;: &lt;span style="color:#f1fa8c"&gt;r&lt;/span&gt;&lt;span style="color:#f1fa8c"&gt;&amp;#39;mysql+pymysql://user:passwd@address1:3306/db_name?charset=UTF8MB4&amp;#39;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#f1fa8c"&gt;&amp;#39;dbms2&amp;#39;&lt;/span&gt;: &lt;span style="color:#f1fa8c"&gt;r&lt;/span&gt;&lt;span style="color:#f1fa8c"&gt;&amp;#39;mysql+pymysql://user:passwd@address2:3306/db_name?charset=UTF8MB4&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#6272a4"&gt;# Model Example&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#ff79c6"&gt;class&lt;/span&gt; &lt;span style="color:#50fa7b"&gt;Network&lt;/span&gt;(db&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;Model):
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; __tablename__ &lt;span style="color:#ff79c6"&gt;=&lt;/span&gt; &lt;span style="color:#f1fa8c"&gt;&amp;#39;network&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; __bind_key__ &lt;span style="color:#ff79c6"&gt;=&lt;/span&gt; &lt;span style="color:#f1fa8c"&gt;&amp;#39;dbms1&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; ip &lt;span style="color:#ff79c6"&gt;=&lt;/span&gt; db&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;Column(db&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;String(&lt;span style="color:#bd93f9"&gt;128&lt;/span&gt;), primary_key&lt;span style="color:#ff79c6"&gt;=&lt;/span&gt;&lt;span style="color:#ff79c6"&gt;True&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; switch &lt;span style="color:#ff79c6"&gt;=&lt;/span&gt; db&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;Column(db&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;String(&lt;span style="color:#bd93f9"&gt;128&lt;/span&gt;))
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; doc &lt;span style="color:#ff79c6"&gt;=&lt;/span&gt; db&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;Column(db&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;JSON)
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id="alchemyencoder"&gt;AlchemyEncoder&lt;/h3&gt;
&lt;p&gt;SQLAlchemy JSON Encoder&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"&gt;&lt;code class="language-py" data-lang="py"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#ff79c6"&gt;class&lt;/span&gt; &lt;span style="color:#50fa7b"&gt;AlchemyEncoder&lt;/span&gt;(json&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;JSONEncoder):
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#ff79c6"&gt;def&lt;/span&gt; &lt;span style="color:#50fa7b"&gt;default&lt;/span&gt;(&lt;span style="font-style:italic"&gt;self&lt;/span&gt;, obj):
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#ff79c6"&gt;if&lt;/span&gt; &lt;span style="color:#8be9fd;font-style:italic"&gt;isinstance&lt;/span&gt;(obj&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;&lt;span style="color:#8be9fd;font-style:italic"&gt;__class__&lt;/span&gt;, DeclarativeMeta):
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#6272a4"&gt;# an SQLAlchemy class&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; fields &lt;span style="color:#ff79c6"&gt;=&lt;/span&gt; {}
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#ff79c6"&gt;for&lt;/span&gt; field &lt;span style="color:#ff79c6"&gt;in&lt;/span&gt; [x &lt;span style="color:#ff79c6"&gt;for&lt;/span&gt; x &lt;span style="color:#ff79c6"&gt;in&lt;/span&gt; &lt;span style="color:#8be9fd;font-style:italic"&gt;dir&lt;/span&gt;(obj) &lt;span style="color:#ff79c6"&gt;if&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;not&lt;/span&gt; x&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;startswith(&lt;span style="color:#f1fa8c"&gt;&amp;#39;_&amp;#39;&lt;/span&gt;) &lt;span style="color:#ff79c6"&gt;and&lt;/span&gt; x &lt;span style="color:#ff79c6"&gt;!=&lt;/span&gt; &lt;span style="color:#f1fa8c"&gt;&amp;#39;metadata&amp;#39;&lt;/span&gt;]:
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; data &lt;span style="color:#ff79c6"&gt;=&lt;/span&gt; obj&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;&lt;span style="color:#50fa7b"&gt;__getattribute__&lt;/span&gt;(field)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#ff79c6"&gt;try&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; json&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;dumps(data) &lt;span style="color:#6272a4"&gt;# this will fail on non-encodable values, like other classes&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; fields[field] &lt;span style="color:#ff79c6"&gt;=&lt;/span&gt; data
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#ff79c6"&gt;except&lt;/span&gt; TypeError:
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#ff79c6"&gt;if&lt;/span&gt; &lt;span style="color:#8be9fd;font-style:italic"&gt;isinstance&lt;/span&gt;(data, datetime):
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; fields[field] &lt;span style="color:#ff79c6"&gt;=&lt;/span&gt; data&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;strftime(&lt;span style="color:#f1fa8c"&gt;&amp;#39;%Y-%m-&lt;/span&gt;&lt;span style="color:#f1fa8c"&gt;%d&lt;/span&gt;&lt;span style="color:#f1fa8c"&gt; %H:%M:%S&amp;#39;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#ff79c6"&gt;elif&lt;/span&gt; &lt;span style="color:#8be9fd;font-style:italic"&gt;isinstance&lt;/span&gt;(data, date):
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; fields[field] &lt;span style="color:#ff79c6"&gt;=&lt;/span&gt; data&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;strftime(&lt;span style="color:#f1fa8c"&gt;&amp;#39;%Y-%m-&lt;/span&gt;&lt;span style="color:#f1fa8c"&gt;%d&lt;/span&gt;&lt;span style="color:#f1fa8c"&gt;&amp;#39;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#ff79c6"&gt;else&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; fields[field] &lt;span style="color:#ff79c6"&gt;=&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;None&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#ff79c6"&gt;return&lt;/span&gt; fields
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#ff79c6"&gt;return&lt;/span&gt; json&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;JSONEncoder&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;default(&lt;span style="font-style:italic"&gt;self&lt;/span&gt;, obj)
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id="flask-basic-route"&gt;Flask Basic Route&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"&gt;&lt;code class="language-py" data-lang="py"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;@app.route(&lt;span style="color:#f1fa8c"&gt;&amp;#39;/api/network/&amp;#39;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#ff79c6"&gt;def&lt;/span&gt; &lt;span style="color:#50fa7b"&gt;api_network&lt;/span&gt;():
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; cur &lt;span style="color:#ff79c6"&gt;=&lt;/span&gt; db&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;session&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;query(Network)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#ff79c6"&gt;return&lt;/span&gt; json&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;dumps({ &lt;span style="color:#f1fa8c"&gt;&amp;#39;data&amp;#39;&lt;/span&gt;: cur&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;all() }, &lt;span style="font-style:italic"&gt;cls&lt;/span&gt;&lt;span style="color:#ff79c6"&gt;=&lt;/span&gt;AlchemyEncoder)
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id="db-model-generate"&gt;DB Model Generate&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"&gt;&lt;code class="language-sh" data-lang="sh"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#6272a4"&gt;# 해당 DB 전체 Table 대상 &lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;$ ./venv/bin/flask-sqlacodegen &lt;span style="color:#f1fa8c"&gt;&amp;#39;mysql+pymysql://user:passwd@address2:3306/db_name&amp;#39;&lt;/span&gt; --flask
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#6272a4"&gt;# 해당 DB 테이블 지정&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;$ ./venv/bin/flask-sqlacodegen &lt;span style="color:#f1fa8c"&gt;&amp;#39;mysql+pymysql://user:passwd@address2:3306/db_name&amp;#39;&lt;/span&gt; --flask --table network,other_table
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id="query-sample"&gt;Query Sample&lt;/h2&gt;
&lt;h3 id="select-all"&gt;Select All&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"&gt;&lt;code class="language-py" data-lang="py"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;cur &lt;span style="color:#ff79c6"&gt;=&lt;/span&gt; db&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;session&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;query(Network)
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id="select-filter-sort"&gt;Select Filter, Sort&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"&gt;&lt;code class="language-py" data-lang="py"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#6272a4"&gt;# Filter &lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;cur &lt;span style="color:#ff79c6"&gt;=&lt;/span&gt; db&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;session&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;query(network)&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;filter(network&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;switch &lt;span style="color:#ff79c6"&gt;==&lt;/span&gt; switch_name)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;cur &lt;span style="color:#ff79c6"&gt;=&lt;/span&gt; db&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;session&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;query(network)&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;filter(network&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;ip&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;like(&lt;span style="color:#f1fa8c"&gt;&amp;#39;&lt;/span&gt;&lt;span style="color:#f1fa8c"&gt;{}&lt;/span&gt;&lt;span style="color:#f1fa8c"&gt;%&amp;#39;&lt;/span&gt;&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;format(ip)))
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;cur &lt;span style="color:#ff79c6"&gt;=&lt;/span&gt; db&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;session&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;query(network)&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;filter(network&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;switch&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;in_((&lt;span style="color:#f1fa8c"&gt;&amp;#39;AA&amp;#39;&lt;/span&gt;, &lt;span style="color:#f1fa8c"&gt;&amp;#39;BB&amp;#39;&lt;/span&gt;)))
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#6272a4"&gt;# Text filter, json&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;cur &lt;span style="color:#ff79c6"&gt;=&lt;/span&gt; db&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;session&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;query(network)&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;filter(text(&lt;span style="color:#f1fa8c"&gt;r&lt;/span&gt;&lt;span style="color:#f1fa8c"&gt;&amp;#39;&amp;#39;&amp;#39;doc-&amp;gt;&amp;gt;&amp;#34;$.name&amp;#34; &amp;lt;&amp;gt; &amp;#39;&amp;#39; &amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;))
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#6272a4"&gt;# OR&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;cur &lt;span style="color:#ff79c6"&gt;=&lt;/span&gt; db&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;session&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;query(network)&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;filter(or_(network&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;ip &lt;span style="color:#ff79c6"&gt;==&lt;/span&gt; ip, network&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;switch &lt;span style="color:#ff79c6"&gt;==&lt;/span&gt; switch_name))
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#6272a4"&gt;# AND&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;cur &lt;span style="color:#ff79c6"&gt;=&lt;/span&gt; db&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;session&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;query(network)&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;filter(and_(network&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;ip &lt;span style="color:#ff79c6"&gt;==&lt;/span&gt; ip, network&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;switch &lt;span style="color:#ff79c6"&gt;==&lt;/span&gt; switch_name))
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#6272a4"&gt;# SORT&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;cur &lt;span style="color:#ff79c6"&gt;=&lt;/span&gt; db&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;session&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;query(network)&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;filter(network&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;switch &lt;span style="color:#ff79c6"&gt;==&lt;/span&gt; switch_name) \
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;order_by(network&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;ip&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;desc())
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id="join"&gt;Join&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"&gt;&lt;code class="language-py" data-lang="py"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#6272a4"&gt;# Join &lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;cur &lt;span style="color:#ff79c6"&gt;=&lt;/span&gt; db&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;session&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;query(Network, NetworkSwitch) \
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;filter(Network&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;ip &lt;span style="color:#ff79c6"&gt;==&lt;/span&gt; NetworkSwitch&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;ip, Network&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;switch &lt;span style="color:#ff79c6"&gt;==&lt;/span&gt; NetworkSwitch&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;switch)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#6272a4"&gt;# Outer Join&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;cur &lt;span style="color:#ff79c6"&gt;=&lt;/span&gt; db&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;session&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;query(Network) \
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;outerjoin(NetworkSwitch, and_(Network&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;ip &lt;span style="color:#ff79c6"&gt;==&lt;/span&gt; NetworkSwitch&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;ip, Network&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;switch &lt;span style="color:#ff79c6"&gt;==&lt;/span&gt; NetworkSwitch&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;switch))
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#6272a4"&gt;# Self Join, Table Alias &lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;NetworkAlias &lt;span style="color:#ff79c6"&gt;=&lt;/span&gt; aliased(Network)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;cur &lt;span style="color:#ff79c6"&gt;=&lt;/span&gt; db&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;session&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;query(Network, NetworkAlias) \
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;filter(Network&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;ip &lt;span style="color:#ff79c6"&gt;==&lt;/span&gt; NetworkAlias&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;ip, Network&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;switch &lt;span style="color:#ff79c6"&gt;==&lt;/span&gt; NetworkAlias&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;switch)
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</description></item></channel></rss>