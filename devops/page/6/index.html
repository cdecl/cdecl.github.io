<!doctype html><html lang=en dir=auto data-theme=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Devops | cdeclog</title><meta name=keywords content><meta name=description content="Devops - cdeclog"><meta name=author content="Byung Kyu KIM"><link rel=canonical href=https://cdecl.github.io/devops/><link crossorigin=anonymous href=/assets/css/stylesheet.f939c4ffefb264e6fe85e04352266f79db6bb1303c8e16ae9b6064c1247b5e32.css integrity="sha256-+TnE/++yZOb+heBDUiZvedtrsTA8jhaum2BkwSR7XjI=" rel="preload stylesheet" as=style><link rel=icon href=https://cdecl.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://cdecl.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://cdecl.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://cdecl.github.io/apple-touch-icon.png><link rel=mask-icon href=https://cdecl.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/rss+xml href=https://cdecl.github.io/devops/index.xml title=rss><link rel=alternate hreflang=en href=https://cdecl.github.io/devops/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51);color-scheme:dark}.list{background:var(--theme)}.toc{background:var(--entry)}}@media(prefers-color-scheme:light){.list::-webkit-scrollbar-thumb{border-color:var(--code-bg)}}</style></noscript><script>localStorage.getItem("pref-theme")==="dark"?document.querySelector("html").dataset.theme="dark":localStorage.getItem("pref-theme")==="light"?document.querySelector("html").dataset.theme="light":window.matchMedia("(prefers-color-scheme: dark)").matches?document.querySelector("html").dataset.theme="dark":document.querySelector("html").dataset.theme="light"</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-VQQHHYPN7K"></script><script>var doNotTrack=!1,dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes";if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-VQQHHYPN7K")}</script><meta property="og:url" content="https://cdecl.github.io/devops/"><meta property="og:site_name" content="cdeclog"><meta property="og:title" content="Devops"><meta property="og:description" content="cdecl's Dev.Ops Blog"><meta property="og:locale" content="ko-kr"><meta property="og:type" content="website"><meta name=twitter:card content="summary"><meta name=twitter:title content="Devops"><meta name=twitter:description content="cdecl's Dev.Ops Blog"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Devops","item":"https://cdecl.github.io/devops/"}]}</script></head><body class=list id=top><header class=header><nav class=nav><div class=logo><a href=https://cdecl.github.io/ accesskey=h title="cdeclog (Alt + H)">cdeclog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://cdecl.github.io/dev/ title=Dev><span>Dev</span></a></li><li><a href=https://cdecl.github.io/devops/ title=DevOps><span class=active>DevOps</span></a></li><li><a href=https://cdecl.github.io/archives/ title=Archive><span>Archive</span></a></li><li><a href=https://cdecl.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://cdecl.github.io/tags/ title=Tags><span>Tags</span></a></li></ul></nav></header><main class=main><header class=page-header><div class=breadcrumbs><a href=https://cdecl.github.io/>Home</a></div><h1>Devops</h1></header><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Act - Run your GitHub Actions locally</h2></header><div class=entry-content><p>ë¡œì»¬ ë¨¸ì‹ ì—ì„œ Gitub Actionsë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆëŠ” ë„êµ¬
Act https://github.com/nektos/act/{:target="_blank"} .github/workflows/ ì—ì„œ GitHub Actionsë¥¼ ì½ê³  ë¡œì»¬ í™˜ê²½ ì‹¤í–‰ Docker ê¸°ë°˜ ì»¨í…Œì´ë„ˆë¡œ ìš´ì˜ macOS ì—ì„œëŠ” Docker Desktop í•„ìš” Linux, MacOS, Windows ì§€ì› ì„¤ì¹˜ ë° ì‹¤í–‰ $ brew install act actions-test/.github/workflows/simple.yml # This is a basic workflow to help you get started with Actions name: CI on: workflow_dispatch: jobs: build: runs-on: ubuntu-latest steps: # - uses: actions/checkout@v3 - name: echo test run: | cat /etc/*-release $ git clone https://github.com/cdecl/actions-test $ cd actions-test $ act [CI/build] ğŸš€ Start image=catthehacker/ubuntu:act-latest [CI/build] ğŸ³ docker pull image=catthehacker/ubuntu:act-latest platform= username= forcePull=true [CI/build] ğŸ³ docker create image=catthehacker/ubuntu:act-latest platform= entrypoint=["tail" "-f" "/dev/null"] cmd=[] [CI/build] ğŸ³ docker run image=catthehacker/ubuntu:act-latest platform= entrypoint=["tail" "-f" "/dev/null"] cmd=[] [CI/build] â­ Run Main echo test [CI/build] ğŸ³ docker exec cmd=[bash --noprofile --norc -e -o pipefail /var/run/act/workflow/0] user= workdir= | DISTRIB_ID=Ubuntu | DISTRIB_RELEASE=22.04 | DISTRIB_CODENAME=jammy | DISTRIB_DESCRIPTION="Ubuntu 22.04.2 LTS" | PRETTY_NAME="Ubuntu 22.04.2 LTS" | NAME="Ubuntu" | VERSION_ID="22.04" | VERSION="22.04.2 LTS (Jammy Jellyfish)" | VERSION_CODENAME=jammy | ID=ubuntu | ID_LIKE=debian | HOME_URL="https://www.ubuntu.com/" | SUPPORT_URL="https://help.ubuntu.com/" | BUG_REPORT_URL="https://bugs.launchpad.net/ubuntu/" | PRIVACY_POLICY_URL="https://www.ubuntu.com/legal/terms-and-policies/privacy-policy" | UBUNTU_CODENAME=jammy [CI/build] âœ… Success - Main echo test [CI/build] ğŸ Job succeeded Secret ë° Env ì ìš© VAR1=1111 VAR2=2222 $ act --env-file my.env --secret-file my.secrets Github Actions ì™€ ëª¨ë“ ê²ƒì´ í˜¸í™˜ë˜ì§€ëŠ” ì•ŠìŒ (e.g. ìŠ¤ì¼€ì¥´) í…ŒìŠ¤íŠ¸ ë° ê°œë°œ ìš©ë„ë¡œ ì‚¬ìš© ì í•©
...</p></div><footer class=entry-footer><span title='2023-04-26 00:00:00 +0900 KST'>April 26, 2023</span>&nbsp;Â·&nbsp;<span>Byung Kyu KIM</span></footer><a class=entry-link aria-label="post link to Act - Run your GitHub Actions locally" href=https://cdecl.github.io/devops/act/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>OrbStack</h2></header><div class=entry-content><p>Docker Desktop ëŒ€ì²´ì œ, Docker containers and Linux machines on macOS
OrbStack https://orbstack.dev/{:target="_blank"} MacOS í™˜ê²½ì—ì„œ Docker Desktop ëŒ€ì²´ì œë¡œ Docker containersë¥¼ ì‹¤í–‰ ê°€ëŠ¥í•˜ê³  ì¶”ê°€ì ìœ¼ë¡œ ë¦¬ëˆ…ìŠ¤ VMë„ ìš´ì˜ê°€ëŠ¥í•¨ OrbStack vs. Docker Desktop{:target="_blank"} Docker Desktop ì— ë¹„í•´ ì ì€ ë¦¬ì†ŒìŠ¤ ë° ë¹ ë¥¸ ì†ë„ Linux machines ì§€ì› ë° Rosetta x86 emulation ê°€ëŠ¥ KubernetesëŠ” ê³„íšì¤‘ OrbStack vs. Colima{:target="_blank"} Docker Desktop ëŒ€ì²´ì²´ë¡œ ë§ì´ ì–¸ê¸‰ë˜ëŠ” Colima ì™€ì˜ ë¹„êµ ì‚¬ìš©í•˜ê³ ìˆëŠ” Docker Desktop ê³¼ Multipass 2ê°œë¥¼ ëŒ€ì²´ ê°€ëŠ¥í•  ê²ƒìœ¼ë¡œ ë³´ì„
Quick start https://docs.orbstack.dev/quick-start{:target="_blank"} brew install orbstack</p></div><footer class=entry-footer><span title='2023-04-25 00:00:00 +0900 KST'>April 25, 2023</span>&nbsp;Â·&nbsp;<span>Byung Kyu KIM</span></footer><a class=entry-link aria-label="post link to OrbStack" href=https://cdecl.github.io/devops/orbstack/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Jq í™œìš©, Json to CSV ë³€í™˜</h2></header><div class=entry-content><p>jq ëª…ë ¹ì–´ë¥¼ í†µí•œ Json to CSV ë³€í™˜
Jq ëª…ë ¹ì–´ í™œìš© https://stedolan.github.io/jq/{:target="_blank"} jq is a lightweight and flexible command-line JSON processor. jqë¥¼ ì‚¬ìš©í•˜ì—¬ JSON ë°°ì—´ê³¼ NDJSON í˜•ì‹ì˜ ë°ì´í„°ë¥¼ CSV í˜•ì‹ìœ¼ë¡œ ë³€í™˜í•˜ëŠ” ì˜ˆì œ JSON ë°°ì—´ì€ ì—¬ëŸ¬ ê°œì˜ JSON ê°ì²´ë¥¼ ëŒ€ê´„í˜¸ë¡œ ë¬¶ì€ í˜•ì‹ì´ê³ , NDJSONì€ Newline Delimited JSONì˜ ì•½ìë¡œ, í•œ ì¤„ì— í•˜ë‚˜ì˜ JSON ê°ì²´ë¥¼ ë‚˜ì—´í•œ í˜•ì‹ NDJSONì€ MongoDBë‚˜ Elasticsearch ë“±ì—ì„œ ì‚¬ìš©ë˜ëŠ” ë°ì´í„° í˜•ì‹ Json ë°°ì—´ì—ì„œ CSV ë°ì´í„° ë³€í™˜ [ { "fs": "/dev/mapper/vgubuntu-root", "type": "ext4", "size": "915G", "used": "135G", "avail": "734G", "usedpercentage": "16%", "mounted": "/" }, { "fs": "/dev/nvme0n1p2", "type": "ext4", "size": "1.4G", "used": "378M", "avail": "939M", "usedpercentage": "29%", "mounted": "/boot" }, { "fs": "/dev/nvme0n1p1", "type": "vfat", "size": "511M", "used": "30M", "avail": "482M", "usedpercentage": "6%", "mounted": "/boot/efi" } ] Header ì¶”ì¶œ CSV íŒŒì¼ì˜ í—¤ë”(keys)ë¥¼ ì¶”ì¶œí•˜ê¸° ìœ„í•´ ë‹¤ìŒê³¼ ê°™ì€ ëª…ë ¹ì–´ë¥¼ ì‚¬ìš©
...</p></div><footer class=entry-footer><span title='2022-09-01 00:00:00 +0900 KST'>September 1, 2022</span>&nbsp;Â·&nbsp;<span>Byung Kyu KIM</span></footer><a class=entry-link aria-label="post link to Jq í™œìš©, Json to CSV ë³€í™˜" href=https://cdecl.github.io/devops/json2csv/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>K3s traefik ingress</h2></header><div class=entry-content><p>K3s traefik ingress ì‚¬ìš© ì„œë¹„ìŠ¤ í…ŒìŠ¤íŠ¸
traefik ingress traefik : https://cdecl.github.io/devops/traefik-proxy/{:target="_blank"} traefik ì„ í™œìš©í•œ ingress êµ¬í˜„ì²´ : K3s ì—ì„œ ë²ˆë“¤ë¡œ ì œê³µ ì„œë¹„ìŠ¤ í…ŒìŠ¤íŠ¸ traefik/whoami ì„œë¹„ìŠ¤ í…ŒìŠ¤íŠ¸ type: NodePort # whoami-deploy.yaml apiVersion: apps/v1 kind: Deployment metadata: name: whoami spec: selector: matchLabels: app: whoami replicas: 2 template: metadata: labels: app: whoami spec: containers: - name: whoami image: traefik/whoami imagePullPolicy: Always ports: - containerPort: 80 --- apiVersion: v1 kind: Service metadata: name: whoami spec: type: NodePort selector: app: whoami ports: - port: 80 targetPort: 80 nodePort: 30080 $ kubectl apply -f whoami-deploy.yaml $ kubectl get pod -A NAMESPACE NAME READY STATUS RESTARTS AGE kube-system local-path-provisioner-7b7dc8d6f5-jnmt5 1/1 Running 0 11m kube-system coredns-b96499967-brb9f 1/1 Running 0 11m kube-system helm-install-traefik-crd-hrfr5 0/1 Completed 0 11m kube-system metrics-server-668d979685-xj5jj 1/1 Running 0 11m kube-system helm-install-traefik-nr5jq 0/1 Completed 1 11m kube-system svclb-traefik-632fd507-mdwnl 2/2 Running 0 11m kube-system traefik-7cd4fcff68-47ms4 1/1 Running 0 11m default whoami-6bbfdbb69c-phxts 1/1 Running 0 102s default whoami-6bbfdbb69c-9rpxv 1/1 Running 0 102s $ kubectl get svc -A NAMESPACE NAME TYPE CLUSTER-IP EXTERNAL-IP PORT(S) AGE default kubernetes ClusterIP 10.43.0.1 &lt;none> 443/TCP 26m kube-system kube-dns ClusterIP 10.43.0.10 &lt;none> 53/UDP,53/TCP,9153/TCP 26m kube-system metrics-server ClusterIP 10.43.90.12 &lt;none> 443/TCP 26m kube-system traefik LoadBalancer 10.43.147.171 192.168.136.5 80:32391/TCP,443:31718/TCP 25m default whoami NodePort 10.43.116.252 &lt;none> 80:30080/TCP 16m $ curl localhost:30080 Hostname: whoami-6bbfdbb69c-9rpxv IP: 127.0.0.1 IP: ::1 IP: 10.42.0.10 IP: fe80::7c46:beff:fe57:f495 RemoteAddr: 10.42.0.1:43930 GET / HTTP/1.1 Host: localhost:30080 User-Agent: curl/7.81.0 Accept: */* Ingress ì ìš© # ingress-rule.yml apiVersion: networking.k8s.io/v1 kind: Ingress metadata: name: main-ingress spec: rules: # - host: domain - http: paths: - path: / pathType: ImplementationSpecific backend: service: name: whoami port: number: 80 Ingress ê°€ Proxy ì—­í• ë¡œ X-Forwarded-For ë“±ì´ ì¶”ê°€ë¨
...</p></div><footer class=entry-footer><span title='2022-08-23 00:00:00 +0900 KST'>August 23, 2022</span>&nbsp;Â·&nbsp;<span>Byung Kyu KIM</span></footer><a class=entry-link aria-label="post link to K3s traefik ingress" href=https://cdecl.github.io/devops/k3s-traefik-ingress/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>trino(presto) nested json ì˜ˆì œ</h2></header><div class=entry-content><p>trino(presto) nested json ë¥¼ ì²˜ë¦¬í•˜ê¸° ìœ„í•œ table schema ì˜ˆì œ
trino(presto) - create table row : json object (nested json) íƒ€ì…ì„ ìœ„í•œ sub column ì •ì˜ array : ë°°ì—´ Example {"id":1,"name":"Alice"} {"id":2,"name":"Bob"} {"id":3,"name":"Carol"} {"id":4,"name":"David", "etc1": [{"key": "key-data11"}, {"key": "key-data22"}] } {"id":5,"name":"Elise", "etc2": ["data1", "data2", "data3"]} create table hive.default.sample ( id varchar, name varchar, etc1 array(row(key varchar)), etc2 array(varchar) ) with ( format = 'json', external_location = 's3a://data/sample/' ) trino cli trino> use hive.default; USE trino:default> select * from sample; id | name | etc1 | etc2 ----+-------+--------------------------------------+----------------------- 1 | Alice | NULL | NULL 2 | Bob | NULL | NULL 3 | Carol | NULL | NULL 4 | David | [{key=key-data11}, {key=key-data22}] | NULL 5 | Elise | NULL | [data1, data2, data3] (5 rows) Query 20220824_000627_00008_qpvtj, FINISHED, 1 node Splits: 1 total, 1 done (100.00%) 0.27 [5 rows, 212B] [18 rows/s, 777B/s]</p></div><footer class=entry-footer><span title='2022-08-23 00:00:00 +0900 KST'>August 23, 2022</span>&nbsp;Â·&nbsp;<span>Byung Kyu KIM</span></footer><a class=entry-link aria-label="post link to trino(presto) nested json ì˜ˆì œ" href=https://cdecl.github.io/devops/presto-json-nested/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>trino(presto), minio docker í…ŒìŠ¤íŠ¸ í™˜ê²½</h2></header><div class=entry-content><p>trino(presto), minio docker í™œìš© í…ŒìŠ¤íŠ¸ í™˜ê²½
trino (hive connector) to minio trino ì˜ hive connector ë¥¼ í™œìš©í•´ì„œ minio ë°ì´í„° ë¶„ì„ í™˜ê²½ Hive connector : https://trino.io/docs/current/connector/hive.html{:target="_blank"} ì°¸ê³  : https://github.com/cdecl/trino-minio-docker{:target="_blank"} docker-compose (trino, minio) version: '3' services: trino: image: trinodb/trino container_name: trino restart: always ports: - "8080:8080" volumes: - ./etc:/etc/trino minio: image: minio/minio restart: always command: server /data --console-address ":9001" container_name: minio environment: MINIO_ROOT_USER: minio MINIO_ROOT_PASSWORD: minio1234 restart: always ports: - "9000:9000" - "9001:9001" volumes: - ./minio-data:/data minio (hive) properties etc/catalog/hive.properties metastore ëŠ” minio catalog ë²„í‚·ì— ì €ì¥ s3a://catalog/trino/ minio ì„¸íŒ… ì •ë³´ : access-key, secret-key, endpoint connector.name=hive-hadoop2 hive.metastore=file hive.metastore.catalog.dir=s3a://catalog/trino/ hive.recursive-directories=true hive.non-managed-table-writes-enabled=true hive.allow-drop-table=true hive.s3.path-style-access=true hive.s3.ssl.enabled=false hive.s3select-pushdown.enabled=true hive.s3.aws-access-key=minio hive.s3.aws-secret-key=minio1234 hive.s3.endpoint=http://minio:9000 docker-compose ì‹¤í–‰ ë° ì´ˆê¸°ê°’ ì„¸íŒ… ## ì‹¤í–‰ $ docker-compose up -d reating network "trino_default" with the default driver Creating minio ... done Creating trino ... done rclone ìœ¼ë¡œ minio ë²„í‚· ìƒì„± # rclone ì„¤ì • $ cat local.conf [local] type = s3 provider = Minio env_auth = false access_key_id = minio secret_access_key = minio1234 endpoint = http://localhost:9000 # create catalog, data directory $ rclone --config local.conf mkdir local:catalog $ rclone --config local.conf mkdir local:data # sample json (ndjson) data) $ cat 1.json {"id":1,"name":"Alice"} {"id":2,"name":"Bob"} {"id":3,"name":"Carol"} # test data copy $ rclone --config local.conf copy 1.json local:data/sample/ schema, table ìƒì„± default schema (db) ìƒì„± ë° external_location table ìƒì„± -- hive ì˜ schema(db) ìƒì„± create schema hive.default; -- table ìƒì„± create table hive.default.sample ( id varchar, name varchar ) with ( format = 'json', external_location = 's3a://data/sample/' ); -- select select * from sample; ì¿¼ë¦¬ í…ŒìŠ¤íŠ¸ (dbeaver)</p></div><footer class=entry-footer><span title='2022-08-19 00:00:00 +0900 KST'>August 19, 2022</span>&nbsp;Â·&nbsp;<span>Byung Kyu KIM</span></footer><a class=entry-link aria-label="post link to trino(presto), minio docker í…ŒìŠ¤íŠ¸ í™˜ê²½" href=https://cdecl.github.io/devops/presto-minio-docker/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>CSV to SQLite3</h2></header><div class=entry-content><p>CSV íŒŒì¼ì„ SQLite3 Import ë° Query
CSV to SQLite3 CSV íŒŒì¼ì„ SQLite3ë¡œ Import ì¿¼ë¦¬
CSV ìƒ˜í”Œ ë°ì´í„° í™•ì¸ $ cat cities.csv "LatD", "LatM", "LatS", "NS", "LonD", "LonM", "LonS", "EW", "City", "State" 41, 5, 59, "N", 80, 39, 0, "W", "Youngstown", OH 42, 52, 48, "N", 97, 23, 23, "W", "Yankton", SD 46, 35, 59, "N", 120, 30, 36, "W", "Yakima", WA ... TIP: cat ëŒ€ì‹  bat ì‚¬ìš©í•˜ë©´ ë” ë‚˜ì€ ë·°ì–´ë¥¼ ì œê³µ
$ bat cities.csv CSV Import .mode csv : csv ëª¨ë“œë¡œ ì „í™˜ .import ./cities.csv ci : ./cities.csv íŒŒì¼ì„ ci í…Œì´ë¸”ë¡œ Import .import --skip 1 ./cities.csv ci : ./cities.csv í…Œì´ë¸”ì´ ì¡´ì¬ í• ë•Œ header ì œì™¸ .import --csv ./cities.csv ci : ./cities.csv csv ëª¨ë“œ inline ì˜µì…˜ # ci.db ìƒì„± ë° ì¸í„°ë™í‹°ë¸Œ ëª¨ë“œ $ sqlite3 ci.db SQLite version 3.37.0 2021-12-09 01:34:53 Enter ".help" for usage hints. sqlite> .mode csv sqlite> .import ./cities.csv ci sqlite> .tables ci sqlite> select count(*) from ci; count(*) 129 sqlite> .mode list sqlite> .header on sqlite> select * from ci limit 10; LatD| "LatM"| "LatS"| "NS"| "LonD"| "LonM"| "LonS"| "EW"| "City"| "State" 41| 5| 59| "N"| 80| 39| 0| "W"| "Youngstown"| OH 42| 52| 48| "N"| 97| 23| 23| "W"| "Yankton"| SD 46| 35| 59| "N"| 120| 30| 36| "W"| "Yakima"| WA 42| 16| 12| "N"| 71| 48| 0| "W"| "Worcester"| MA 43| 37| 48| "N"| 89| 46| 11| "W"| "Wisconsin Dells"| WI 36| 5| 59| "N"| 80| 15| 0| "W"| "Winston-Salem"| NC 49| 52| 48| "N"| 97| 9| 0| "W"| "Winnipeg"| MB 39| 11| 23| "N"| 78| 9| 36| "W"| "Winchester"| VA 34| 14| 24| "N"| 77| 55| 11| "W"| "Wilmington"| NC 39| 45| 0| "N"| 75| 33| 0| "W"| "Wilmington"| DE Inline command $ sqlite3 /tmp/t.db ".import -csv ./cities.csv ci" "select * from ci" -header LatD| "LatM"| "LatS"| "NS"| "LonD"| "LonM"| "LonS"| "EW"| "City"| "State" 41| 5| 59| "N"| 80| 39| 0| "W"| "Youngstown"| OH 42| 52| 48| "N"| 97| 23| 23| "W"| "Yankton"| SD 46| 35| 59| "N"| 120| 30| 36| "W"| "Yakima"| WA 42| 16| 12| "N"| 71| 48| 0| "W"| "Worcester"| MA 43| 37| 48| "N"| 89| 46| 11| "W"| "Wisconsin Dells"| WI 36| 5| 59| "N"| 80| 15| 0| "W"| "Winston-Salem"| NC 49| 52| 48| "N"| 97| 9| 0| "W"| "Winnipeg"| MB 39| 11| 23| "N"| 78| 9| 36| "W"| "Winchester"| VA 34| 14| 24| "N"| 77| 55| 11| "W"| "Wilmington"| NC 39| 45| 0| "N"| 75| 33| 0| "W"| "Wilmington"| DE</p></div><footer class=entry-footer><span title='2022-08-09 00:00:00 +0900 KST'>August 9, 2022</span>&nbsp;Â·&nbsp;<span>Byung Kyu KIM</span></footer><a class=entry-link aria-label="post link to CSV to SQLite3" href=https://cdecl.github.io/devops/csv-to-sqlite3/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>ripgrep, rg</h2></header><div class=entry-content><p>í•˜ìœ„ ë””ë ‰í† ë¦¬ì—ì„œ ì •ê·œì‹ íŒ¨í„´ì„ ì¬ê·€ì ìœ¼ë¡œ ê²€ìƒ‰í•˜ëŠ” ë¼ì¸ ì§€í–¥ ê²€ìƒ‰ ë„êµ¬
ripgrep https://github.com/BurntSushi/ripgrep{:target="_blank"} rustë¡œ ë§Œë“¤ì–´ì§„ í¬ë¡œìŠ¤í”Œë«í¼ ì§€í–¥ grep ëŒ€ì²´ë„êµ¬ íŠ¹ì§• ì½”ë“œ ê²€ìƒ‰ì— íŠ¹í™”ë˜ê³  ê¸°ë³¸ì ìœ¼ë¡œ ì¬ê·€ì  ë””ë ‰í† ë¦¬ ê²€ìƒ‰ ì‚¬ìš©
ìë™ í•„í„°ë§ : ê¸°ë³¸ì ìœ¼ë¡œ ë””ë ‰í† ë¦¬ë¥¼ ê²€ìƒ‰í•  ë•Œ ì•„ë˜ ì¡°ê±´ì€ ê²€ìƒ‰í•˜ì§€ ì•ŠìŒ
.gitignore .ignore .rgignore ëª…ì‹œë˜ì–´ ìˆëŠ” íŒŒì¼ì€ ê¸°ë³¸ì ìœ¼ë¡œ ê²€ìƒ‰í•˜ì§€ ì•ŠìŒ â†’ --no-ignore ë¡œ íšŒí”¼ ìˆ¨ê²¨ì§„ íŒŒì¼ ë° ë””ë ‰í† ë¦¬ â†’ --hidden ë¡œ íšŒí”¼ ë°”ì´ë„ˆë¦¬ íŒŒì¼ (ripgrepì€ NULë°”ì´íŠ¸ ìˆìœ¼ë©´ ë°”ì´ë„ˆë¦¬ë¡œ ê°„ì£¼) â†’ --text, -a ë¡œ íšŒí”¼ ì‹¬ë³¼ë¦­ ë§í¬ ì—°ê²° â†’ --follow, -L ë¡œ ì—°ê²° ì „ì²´ í•„í„°ë§ì„ íšŒí”¼í•˜ê¸° (ë‹¨ê³„ë³„) â†’ -u or -uu or -uuu (quivalent to â€˜grep -râ€™)
...</p></div><footer class=entry-footer><span title='2022-07-27 00:00:00 +0900 KST'>July 27, 2022</span>&nbsp;Â·&nbsp;<span>Byung Kyu KIM</span></footer><a class=entry-link aria-label="post link to ripgrep, rg" href=https://cdecl.github.io/devops/ripgrep/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Ansible dynamic inventory - AWS EC2</h2></header><div class=entry-content><p>Ansible aws_ec2 plugin í™œìš©, AWS EC2 ë™ì  Inventory êµ¬ì„±
Ansible plugin : aws_ec2 https://docs.ansible.com/ansible/2.9/plugins/inventory/aws_ec2.html{:target="_blank"} Get inventory hosts from Amazon Web Services EC2 Requirements python package : boto3, bo YAML ì„¤ì • íŒŒì¼ ì´ë¦„ì´ aws_ec2.(yml|yaml) ë¡œ ëë‚˜ì•¼ í•¨ $ ansible --version ansible 2.9.6 config file = /etc/ansible/ansible.cfg configured module search path = ['/home/cdecl/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules'] ansible python module location = /usr/lib/python3/dist-packages/ansible executable location = /usr/bin/ansible python version = 3.8.10 (default, Jun 2 2021, 10:49:15) [GCC 9.4.0] # install boto3, bo $ pip3 install boto3 ê¸°ë³¸ì„¤ì • aws_ec2.yaml plugin : í”„ëŸ¬ê·¸ì¸ ì´ë¦„, í•„ìˆ˜ regions : ì§€ì •í•˜ë©´ ë” ë¹ ë¥¸ ì¡°íšŒ plugin: aws_ec2 regions: - ap-northeast-2 # .aws/credendial íŒŒì¼ì´ ì—†ìœ¼ë©´ aws_access_key_id: AKIA3************** aws_secret_access_key: 1oxRajyBX********************** ~/.aws/credentials [default] aws_access_key_id = AKIA3************** aws_secret_access_key = 1oxRajyBX********************** Inventory í™•ì¸ ê¸°ë³¸ aws_ec2 ê·¸ë£¹ìœ¼ë¡œ ìƒì„± # json í˜•íƒœë¡œ ec2 node ì •ë³´ ë° group ì •ë³´ ë¦¬ìŠ¤íŠ¸ $ ansible-inventory -i aws_ec2.yaml --list ... "all": { "children": [ "aws_ec2", "ungrouped" ] }, "aws_ec2": { "hosts": [ "ip-10-211-20-159.ap-northeast-2.compute.internal", "ip-10-211-20-229.ap-northeast-2.compute.internal", "ip-10-211-20-45.ap-northeast-2.compute.internal" ] } } # inventory ì •ë³´ë¥¼ ê·¸ë˜í”„ í˜•íƒœë¡œ í‘œì‹œ $ ansible-inventory -i aws_ec2.yaml --graph @all: |--@aws_ec2: | |--ip-10-211-20-159.ap-northeast-2.compute.internal | |--ip-10-211-20-229.ap-northeast-2.compute.internal | |--ip-10-211-20-45.ap-northeast-2.compute.inte # ansible ëª…ë ¹ìœ¼ë¡œ í™•ì¸ $ ansible -i aws_ec2.yaml --list-hosts all hosts (3): ip-10-211-20-229.ap-northeast-2.compute.internal ip-10-211-20-159.ap-northeast-2.compute.internal ip-10-211-20-45.ap-northeast-2.compute.internal í•„í„° ë° ê·¸ë£¹í™” ì˜ˆì œ : https://docs.ansible.com/ansible/2.9/plugins/inventory/aws_ec2.html#examples{:target="_blank"} filters : í•„í„°ë¡œ ì›í•˜ëŠ” í•­ëª©ë§Œ ê°€ì ¸ì˜´ AWS CLI ëª…ë ¹ describe-instances â€“filters í•­ëª© ì°¸ê³  https://docs.aws.amazon.com/cli/latest/reference/ec2/describe-instances.html#options{:target="_blank"} keyed_groups : Inventory ê·¸ë£¹í™” í•­ëª© plugin: aws_ec2 regions: - ap-northeast-2 filters: # tag ì •ë³´ê°€ AutoDelete:False ì¸ ì¸ìŠ¤í„´ìŠ¤ tag:AutoDelete: "False" # running ìƒíƒœ ì¸ìŠ¤í„´ìŠ¤ instance-state-name: 'running' keyed_groups: # tag ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ê·¸ë£¹í™”, "prefix_key_value" í˜•ì‹ì˜ ê·¸ë£¹ì´ë¦„ - prefix: tag key: tags # tag ë¡œ ê·¸ë£¹í™” $ ansible-inventory -i aws_ec2.yaml --graph @all: |--@aws_ec2: | |--ip-10-211-20-159.ap-northeast-2.compute.internal | |--ip-10-211-20-229.ap-northeast-2.compute.internal | |--ip-10-211-20-45.ap-northeast-2.compute.internal |--@tag_AutoDelete_False: | |--ip-10-211-20-159.ap-northeast-2.compute.internal | |--ip-10-211-20-229.ap-northeast-2.compute.internal | |--ip-10-211-20-45.ap-northeast-2.compute.internal ... |--@tag_Name_kube01: | |--ip-10-211-20-45.ap-northeast-2.compute.internal |--@tag_Name_kube02: | |--ip-10-211-20-159.ap-northeast-2.compute.internal |--@tag_Name_kube03: | |--ip-10-211-20-229.ap-northeast-2.compute.internal |--@ungrouped: # ansible ëª…ë ¹ìœ¼ë¡œ í™•ì¸ $ ansible -i aws_ec2.yaml tag_AutoDelete_False --list-hosts hosts (3): ip-10-211-20-229.ap-northeast-2.compute.internal ip-10-211-20-159.ap-northeast-2.compute.internal ip-10-211-20-45.ap-northeast-2.compute.internal $ ansible -i aws_ec2.yaml tag_Name_kube01 --list-hosts hosts (1): ip-10-211-20-45.ap-northeast-2.compute.internal Host ì—°ê²°ì„ ìœ„í•œ inventory parameters ì¶”ê°€ multiple inventoryë¡œ ì •ë³´ ì¶”ê°€ https://docs.ansible.com/ansible/2.9/user_guide/intro_inventory.html#connecting-to-hosts-behavioral-inventory-parameters{:target="_blank"} # aws.host [win:children] tag_AutoDelete_False [win:vars] ansible_user=rundeck ansible_password=&lt;passowrd> ansible_connection=winrm ansible_port=5985 $ ansible-inventory -i aws_ec2.yaml -i aws.host --vars --list { "_meta": { "hostvars": { "ip-10-211-20-159.ap-northeast-2.compute.internal": { "ami_launch_index": 1, "ansible_connection": "winrm", "ansible_password": "&lt;passowrd>", "ansible_port": 5985, "ansible_user": "ansible", "architecture": "x86_64", ... ansible-inventory --list ì˜µì…˜ìœ¼ë¡œ hosts íŒŒì¼ í˜•ì‹ êµ¬ì„± $ ansible-inventory -i aws_ec2.yaml --list | jq -r '._meta.hostvars[] | "\(.private_ip_address) \(.tags.Name) "' 10.211.20.159 kube02 10.211.20.229 kube03 10.211.20.45 kube01 Ansible EC2 Dynamic inventory minimum IAM policies https://stackoverflow.com/questions/30519470/ansible-ec2-dynamic-inventory-minimum-iam-policies{:target="_blank"} { "Version": "2012-10-17", "Statement": [ { "Sid": "Demo201505282045", "Effect": "Allow", "Action": [ "ec2:Describe*", "route53:ListHostedZones", "route53:ListResourceRecordSets" ], "Resource": "*" } ] }</p></div><footer class=entry-footer><span title='2022-07-16 00:00:00 +0900 KST'>July 16, 2022</span>&nbsp;Â·&nbsp;<span>Byung Kyu KIM</span></footer><a class=entry-link aria-label="post link to Ansible dynamic inventory - AWS EC2" href=https://cdecl.github.io/devops/ansible-dynamic-inventory-aws-ec2/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Multipass, Ubuntu VM ì„¤ì •</h2></header><div class=entry-content><p>Canonical ì¬ë‹¨ì—ì„œ ì§€ì›í•˜ëŠ” ë‹¨ì¼ ëª…ë ¹ìœ¼ë¡œ Ubuntu VM êµ¬ì„± í•  ìˆ˜ ìˆëŠ” ë„êµ¬
Multipass https://multipass.run/{:target="_blank"} ìµœì†Œí•œì˜ ì˜¤ë²„í—¤ë“œë¥¼ ìœ„í•œ ê° í”Œë«í¼ ì§€ì› Windows : Hyper-V macOS : QEMU, HyperKit Linux : LXD Multipass install https://multipass.run/install{:target="_blank"} í”Œë«í¼ ë³„ íŒ¨í‚¤ì§€ ì„¤ì¹˜ ë°©ë²• # windows $ choco install multipass # macOS $ brew install multipass Multipass ì£¼ìš” ëª…ë ¹ ë° VM Instance ìƒì„± ì£¼ìš” ëª…ë ¹ì–´ launch : Ubuntu instance ìƒì„± ë° ì‹œì‘ start, stop, restart : ì‹œì‘ ì¤‘ì§€ delete : Ubuntu instance ì‚­ì œ purge : ì‚­ì œëœ ì´ë¯¸ì§€ ì˜êµ¬ ì‚­ì œ shell : Instance ë‚´ë¶€ shell ë¡œ ì ‘ì† list : ìƒì„±ëœ Instance í™•ì¸ info : Instance ì •ë³´ í™•ì¸ $ multipass --help ... Available commands: alias Create an alias aliases List available aliases authenticate Authenticate client delete Delete instances exec Run a command on an instance find Display available images to create instances from get Get a configuration setting help Display help about a command info Display information about instances launch Create and start an Ubuntu instance list List all available instances mount Mount a local directory in the instance networks List available network interfaces purge Purge all deleted instances permanently recover Recover deleted instances restart Restart instances set Set a configuration setting shell Open a shell on a running instance start Start instances stop Stop running instances suspend Suspend running instances transfer Transfer files between the host and instances umount Unmount a directory from an instance unalias Remove an alias version Show version details Ubuntu VM Instance ìƒì„± : ê¸°ë³¸ ìƒì„± # node1 ì´ë¦„ì˜ instance ìƒì„± $ multipass launch -n node01 Launched: node01 # ê¸°ë³¸ lts ì´ë¯¸ì§€ë¡œ ìƒì„± : Ubuntu 20.04 LTS $ multipass list Name State IPv4 Image node01 Running 192.168.196.207 Ubuntu 20.04 LTS # instace ì •ë³´ $ multipass info node01 Name: node01 State: Running IPv4: 192.168.196.207 Release: Ubuntu 20.04.4 LTS Image hash: 75a04c7eed58 (Ubuntu 20.04 LTS) Load: 0.38 0.15 0.05 Disk usage: 1.4G out of 4.7G Memory usage: 162.4M out of 912.5M Mounts: -- ê¸°ë³¸ ì„¤ì •ìœ¼ë¡œ Instance ìƒì„±ì‹œ, Disk ë“±ì˜ ë¦¬ì†ŒìŠ¤ê°€ ë¶€ì¡± í•  ìˆ˜ ìˆìŒ
...</p></div><footer class=entry-footer><span title='2022-07-04 00:00:00 +0900 KST'>July 4, 2022</span>&nbsp;Â·&nbsp;<span>Byung Kyu KIM</span></footer><a class=entry-link aria-label="post link to Multipass, Ubuntu VM ì„¤ì •" href=https://cdecl.github.io/devops/multipass-ubuntu/></a></article><footer class=page-footer><nav class=pagination><a class=prev href=https://cdecl.github.io/devops/page/5/>Â«&nbsp;Prev&nbsp;
</a><a class=next href=https://cdecl.github.io/devops/page/7/>Next&nbsp;&nbsp;Â»</a></nav></footer></main><footer class=footer><span>&copy; 2026 <a href=https://cdecl.github.io/>cdeclog</a></span> Â·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");if(menu){const e=localStorage.getItem("menu-scroll-position");e&&(menu.scrollLeft=parseInt(e,10)),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}}document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{const e=document.querySelector("html");e.dataset.theme==="dark"?(e.dataset.theme="light",localStorage.setItem("pref-theme","light")):(e.dataset.theme="dark",localStorage.setItem("pref-theme","dark"))})</script></body></html>