<!doctype html><html lang=en dir=auto data-theme=auto><head><meta name=generator content="Hugo 0.154.5"><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>cdeclog</title><meta name=description content="cdecl's Development Blog - Dev, DevOps, Etc."><meta name=author content="Byung Kyu KIM"><link rel=canonical href=https://cdecl.github.io/><link crossorigin=anonymous href=/assets/css/stylesheet.d980bb9fb2cba61af0aead0606b5eb221d7e358748ac394b60233d95d626c563.css integrity="sha256-2YC7n7LLphrwrq0GBrXrIh1+NYdIrDlLYCM9ldYmxWM=" rel="preload stylesheet" as=style><link rel=icon href=https://cdecl.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://cdecl.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://cdecl.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://cdecl.github.io/apple-touch-icon.png><link rel=mask-icon href=https://cdecl.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/rss+xml href=https://cdecl.github.io/index.xml title=rss><link rel=alternate type=application/json href=https://cdecl.github.io/index.json title=json><link rel=alternate hreflang=en href=https://cdecl.github.io/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51);color-scheme:dark}.list{background:var(--theme)}.toc{background:var(--entry)}}@media(prefers-color-scheme:light){.list::-webkit-scrollbar-thumb{border-color:var(--code-bg)}}</style></noscript><script>localStorage.getItem("pref-theme")==="dark"?document.querySelector("html").dataset.theme="dark":localStorage.getItem("pref-theme")==="light"?document.querySelector("html").dataset.theme="light":window.matchMedia("(prefers-color-scheme: dark)").matches?document.querySelector("html").dataset.theme="dark":document.querySelector("html").dataset.theme="light"</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-VQQHHYPN7K"></script><script>var doNotTrack=!1,dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes";if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-VQQHHYPN7K")}</script><meta property="og:url" content="https://cdecl.github.io/"><meta property="og:site_name" content="cdeclog"><meta property="og:title" content="cdeclog"><meta property="og:description" content="cdecl's Development Blog - Dev, DevOps, Etc."><meta property="og:locale" content="ko-kr"><meta property="og:type" content="website"><meta name=twitter:card content="summary"><meta name=twitter:title content="cdeclog"><meta name=twitter:description content="cdecl's Development Blog - Dev, DevOps, Etc."><script type=application/ld+json>{"@context":"https://schema.org","@type":"Organization","name":"cdeclog","url":"https://cdecl.github.io/","description":"cdecl's Development Blog - Dev, DevOps, Etc.","logo":"https://cdecl.github.io/favicon.ico","sameAs":["https://github.com/cdecl","https://cdecl.tistory.com/"]}</script></head><body class=list id=top><header class=header><nav class=nav><div class=logo><a href=https://cdecl.github.io/ accesskey=h title="cdeclog (Alt + H)">cdeclog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://cdecl.github.io/dev/ title=Dev><span>Dev</span></a></li><li><a href=https://cdecl.github.io/devops/ title=DevOps><span>DevOps</span></a></li><li><a href=https://cdecl.github.io/archives/ title=Archive><span>Archive</span></a></li><li><a href=https://cdecl.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://cdecl.github.io/tags/ title=Tags><span>Tags</span></a></li></ul></nav></header><main class=main><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Traefik Proxy</h2></header><div class=entry-content><p>Docker ê¸°ë°˜ ì„œë¹„ìŠ¤ ìë™ ê°ì§€ ë° ìš”ì²­ì„ ì²˜ë¦¬í•˜ëŠ” Reverse proxy
Traefik Proxy https://doc.traefik.io/traefik/{:target="_blank"} docker.sock ì„ í†µí•´ Rule ê¸°ë°˜ ì„œë¹„ìŠ¤ë¥¼ ì°¾ê³  ìš”ì²­ì„ ì²˜ë¦¬í•¨ Docker ì´ì™¸ì— Kubernetes, Docker Swarm, AWS, Mesos, Marathon ë“±ì„ ì§€ì› Quick Start https://doc.traefik.io/traefik/getting-started/quick-start/{:target="_blank"} docker-compose.yml reverse-proxy : traefik reverse proxy ì„œë¹„ìŠ¤ Docker Out of Docker (DooD) ê°™ì€ í˜•íƒœë¡œ ì„œë¹„ìŠ¤ ê°ì§€ ì„œë¹„ìŠ¤ì™€ ê°™ì€ Docker network ë‚´ì— ìˆì–´ì•¼ í˜¸ì¶œì´ ê°€ëŠ¥ whoami : Client í˜¸ì¶œì •ë³´ë¥¼ ë³´ì—¬ì£¼ëŠ” ê°„ë‹¨í•œ ì„œë¹„ìŠ¤ labels ì„ í†µí•´ whoami ì„œë¹„ìŠ¤ Rule ë“±ë¡ Host ê¸°ë°˜ Rule ì ìš© : "traefik.http.routers.whoami.rule=Host(whoami.localhost)" traefik.http.routers.&lt;router_name>.rule= Docker Routers ê·œì¹™{:target="_blank"} Rule ì¢…ë¥˜{:target="_blank"} ì„œë¹„ìŠ¤ì— Port ê°€ ë…¸ì¶œ ë˜ì–´ì•¼ í•¨ : Expose port (or Publish port) version: '3' services: reverse-proxy: # The official v2 Traefik docker image image: traefik:v2.6 # Enables the web UI and tells Traefik to listen to docker command: --api.insecure=true --providers.docker ports: # The HTTP port - "80:80" # The Web UI (enabled by --api.insecure=true) - "8080:8080" volumes: # So that Traefik can listen to the Docker events - /var/run/docker.sock:/var/run/docker.sock whoami: # A container that exposes an API to show its IP address image: traefik/whoami labels: - "traefik.http.routers.whoami.rule=Host(`whoami.localhost`)" # reverse-proxy ì„œë¹„ìŠ¤ ì‹œì‘ $ docker-compose up -d reverse-proxy # whoami ì„œë¹„ìŠ¤ ì‹œì‘ $ docker-compose up -d whoami $ docker ps CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES e457ff5e01cb traefik/whoami "/whoami" 59 minutes ago Up 59 minutes 80/tcp traefik_whoami_1 Dashboard Router í™•ì¸ ...</p></div><footer class=entry-footer><span title='2022-03-05 00:00:00 +0900 KST'>March 5, 2022</span>&nbsp;Â·&nbsp;<span>Byung Kyu KIM</span></footer><a class=entry-link aria-label="post link to Traefik Proxy" href=https://cdecl.github.io/devops/traefik-proxy/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Git Repository ë³µì œ, Branch ë™ê¸°í™” ê´€ë¦¬</h2></header><div class=entry-content><p>Git Repository ë³µì œ ë° Branch ê´€ë¦¬ ê°€ì´ë“œ Git Repository ë³µì œ Remote â†’ Local ë³µì œ Git ì €ì¥ì†Œë¥¼ ë³µì œí•˜ëŠ” ë°©ë²•ì—ëŠ” ì—¬ëŸ¬ ê°€ì§€ê°€ ìˆìœ¼ë©°, ê°ê°ì˜ ë°©ì‹ì— ë”°ë¼ ë‹¤ë¥¸ íŠ¹ì§•ì´ ìˆìŠµë‹ˆë‹¤.
--mirror ë³µì œì˜ íŠ¹ì§• git clone --mirror: Remote repositoryì˜ ëª¨ë“  ì°¸ì¡°(refs)ë¥¼ í¬í•¨í•˜ì—¬ Localì— ì €ì¥ ê¸°ë³¸ cloneê³¼ ë‹¬ë¦¬ ì‘ì—… ë””ë ‰í† ë¦¬ ì—†ì´ ì €ì¥ì†Œì˜ ë©”íƒ€ë°ì´í„° ì „ì²´ë¥¼ ë³µì œ ì£¼ë¡œ ì €ì¥ì†Œ ë°±ì—…ì´ë‚˜ ì™„ì „í•œ ë¯¸ëŸ¬ë§ì— ì‚¬ìš© # mirror ë³µì œ $ git clone --mirror https://github.com/cdecl/test $ tree -d . â””â”€â”€ test.git â”œâ”€â”€ branches â”œâ”€â”€ hooks â”œâ”€â”€ info â”œâ”€â”€ objects â”‚Â â”œâ”€â”€ info â”‚Â â””â”€â”€ pack â””â”€â”€ refs â”œâ”€â”€ heads â””â”€â”€ tags ğŸ’¡ ì¶”ê°€ ì •ë³´:
...</p></div><footer class=entry-footer><span title='2022-02-23 00:00:00 +0900 KST'>February 23, 2022</span>&nbsp;Â·&nbsp;<span>Byung Kyu KIM</span></footer><a class=entry-link aria-label="post link to Git Repository ë³µì œ, Branch ë™ê¸°í™” ê´€ë¦¬" href=https://cdecl.github.io/dev/git-mirror-branch/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>ReaR (Relax & Recover) Basic</h2></header><div class=entry-content><p>ReaR(Relax & Recover), Linux ì¬í•´ ë³µêµ¬ ë„êµ¬
ReaR https://relax-and-recover.org/{:target="_blank"} Manual Page : https://github.com/rear/rear/blob/master/doc/rear.8.adoc{:target="_blank"} OSì˜ ë¶€íŒ… ê°€ëŠ¥í•œ ë³µêµ¬ ì‹œìŠ¤í…œ êµ¬ì„±, ì‹œìŠ¤í…œ íŒŒì¼ ë°±ì—… ë° ë³µêµ¬ ì§€ì› Simple Example NFS ë°±ì—… ì„œë²„ êµ¬ì„± ReaR ë°±ì—… ë° ë³µêµ¬ í…ŒìŠ¤íŠ¸ centos7, Hyper-v í™˜ê²½ í…ŒìŠ¤íŠ¸ https://access.redhat.com/solutions/2115051{:target="_blank"} Backupìš© NFS ì„œë²„ êµ¬ì„± ë°±ì—…ì„œë²„ NFS êµ¬ì„± # nfs-utils ì„¤ì¹˜ $ sudo yum install nfs-utils # ë””ë ‰í† ë¦¬ ìƒì„± $ sudo mkdir -p /storage/rear # nfs ì„œë²„ ì„¤ì • $ cat /etc/exports /storage *(rw,sync,no_root_squash) # nfs-server start # sudo systemctl enable nfs-server $ sudo systemctl start nfs-server ëŒ€ìƒ ì„œë²„ êµ¬ì„± RaaR ì„¤ì¹˜ ë° êµ¬ì„± # nfs clients $ sudo yum install nfs-utils # ReaR ì„¤ì¹˜ sudo yum install nfs-utils # í•„ìš”ì— ë”°ë¼ ì•„ë˜ ëª¨ë“ˆ ì„¤ì¹˜ # rear -d -v mkbackup ì‹œ í•´ë‹¹ ëª¨ë“ˆì´ ì—†ë‹¤ê³  ë‚˜ì˜¤ë©´ # WARNING: /usr/lib/grub/x86_64-efi/moddep.lst not found, grub2-mkimage will likely fail. # Please install the grub2-efi-x64-modules package to fix this. $ sudo yum install grub2-efi-x64-modules RaaR ì„¤ì • https://github.com/rear/rear/blob/master/doc/user-guide/03-configuration.adoc{:target="_blank"} /etc/rear/local.conf OUTPUT : Rescue media, BOOTìš© ì´ë¯¸ì§€ ISO : ISO BOOT ì´ë¯¸ì§€ ìƒì„± BACKUP, BACKUP_URL : Backup/Restore strategy, ì‹œìŠ¤í…œíŒŒì¼ ë° ë°±ì—… ë°ì´í„° ì¢…ë¥˜ ë° ìœ„ì¹˜ ì§€ì • NETFS : Use Relax-and-Recover internal backup with tar or rsync (or similar) BACKUP_URL ê²½ë¡œ ë° HostName í´ë”ì— ìƒì„± BACKUP_PROG_EXCLUDE : ë°±ì—… ì œì™¸ ê²½ë¡œ ì§€ì • # /etc/rear/local.conf OUTPUT=ISO OUTPUT_URL=nfs://192.168.137.100/storage/rear BACKUP=NETFS BACKUP_URL=nfs://192.168.137.100/storage/rear # BACKUP_TYPE=incremental # FULLBACKUPDAY=Sun # BACKUP_PROG_EXCLUDE=('/syslogs/logs/*' '/var/log/*') Backup ì‹¤í–‰ mkbackup : create rescue media and backup system mkbackuponly : backup system without creating rescue media mkrescue : create rescue media only ## verbose mode # -d : debug mode ì˜ ê²½ìš° /tmp ë°‘ì— íŒŒì¼ì„ ì§€ìš°ì§€ ì•ŠìŒ $ sudo rear -v mkbackup Backup ë°ì´í„° í™•ì¸ # Backup ì„œë²„ $ hostname -I 192.168.137.100 # hostname ë””ë ‰í† ë¦¬ë³„ë¡œ ë°±ì—… $ tree /storage /storage â””â”€â”€ rear â”œâ”€â”€ node1 â”‚Â â”œâ”€â”€ README â”‚Â â”œâ”€â”€ VERSION â”‚Â â”œâ”€â”€ backup.log â”‚Â â”œâ”€â”€ backup.tar.gz â”‚Â â”œâ”€â”€ rear-node1.iso â”‚Â â””â”€â”€ rear-node1.log â””â”€â”€ node2 â”œâ”€â”€ README â”œâ”€â”€ VERSION â”œâ”€â”€ backup.log â”œâ”€â”€ backup.tar.gz â”œâ”€â”€ rear-node2.iso â””â”€â”€ rear-node2.log ë³µêµ¬ ì‹¤í–‰ ë°±ì—…ëœ rescue media (iso)ë¡œ ë¶€íŒ…ì„ í•œ í›„, ë³µêµ¬ ëª¨ë“œë¡œ ì‹¤í–‰
...</p></div><footer class=entry-footer><span title='2022-02-07 00:00:00 +0900 KST'>February 7, 2022</span>&nbsp;Â·&nbsp;<span>Byung Kyu KIM</span></footer><a class=entry-link aria-label="post link to ReaR (Relax & Recover) Basic" href=https://cdecl.github.io/devops/rear-basic/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Kustomize Basic</h2></header><div class=entry-content><p>kubernetes manifest ë¦¬ì†ŒìŠ¤ ê´€ë¦¬ ë„êµ¬
Kustomize https://kubernetes.io/ko/docs/tasks/manage-kubernetes-objects/kustomization/{:target="_blank"} kubernetes manifest (yaml) íŒŒì¼ì„ Template í˜•íƒœë¡œ ê´€ë¦¬ Patch(Merge) ë° ë°°í¬ í•´ì£¼ëŠ” íˆ´ kubernetes 1.14 ì´í›„, kubectl ëª…ë ¹ì–´ë¡œ kustomization ì§€ì› Simple Example $ tree . . â”œâ”€â”€ deployment.yaml â”œâ”€â”€ kustomization.yaml â””â”€â”€ version.yaml kustomization.yaml Manifest íŒŒì¼ì˜ ê¸°ë³¸ êµ¬ì¡° ë° ë¦¬ì†ŒìŠ¤, íŒ¨ì¹˜ íŒŒì¼ì„ ê¸°ìˆ í•˜ëŠ” íŒŒì¼ resources: - deployment.yaml patchesStrategicMerge: - version.yaml resources : ë¦¬ì†ŒìŠ¤ íŒŒì¼ ë¦¬ìŠ¤íŠ¸ resources ì´ì™¸ì— configMapGenerator, secretGenerator ê¸°ëŠ¥ë„ ìˆìŒ https://kubernetes.io/ko/docs/tasks/manage-kubernetes-objects/kustomization/#kustomize-%EA%B8%B0%EB%8A%A5-%EB%A6%AC%EC%8A%A4%ED%8A%B8{:target="_blank"} patchesStrategicMerge : resourcesì˜ Patch íŒŒì¼ Patch : yaml file merge
...</p></div><footer class=entry-footer><span title='2021-12-15 00:00:00 +0900 KST'>December 15, 2021</span>&nbsp;Â·&nbsp;<span>Byung Kyu KIM</span></footer><a class=entry-link aria-label="post link to Kustomize Basic" href=https://cdecl.github.io/devops/kustomize-basic/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>C++ Lambda í‘œí˜„ì‹</h2></header><div class=entry-content><p>C++14, C++17, C++20 ë²„ì „ë³„ Lambda í‘œí˜„ ì •ë¦¬
The Evolutions of Lambdas in C++14, C++17 and C++20 https://www.fluentcpp.com/2021/12/13/the-evolutions-of-lambdas-in-c14-c17-and-c20/{:target="_blank"} í•´ë‹¹ ê¸€ì„ ì°¸ê³ í•˜ì—¬ ì˜ˆì œ ìì²´ ì‘ì„± C++14 Default parameters #include &lt;iostream> using namespace std; int main() { auto fn = [](int a, int b = 0) { return a + b; }; cout &lt;&lt; fn(1) &lt;&lt; endl; // 1 cout &lt;&lt; fn(1, 2) &lt;&lt; endl; // 3 } Template parameters #include &lt;iostream> #include &lt;string> #include &lt;vector> using namespace std; int main() { auto fn = [](auto && c) { return c.size(); }; vector&lt;int> v = {1, 2, 3}; cout &lt;&lt; fn(v) &lt;&lt; endl; // 3 string s = "12345"; cout &lt;&lt; fn(s) &lt;&lt; endl; // 5 } Generalised capture #include &lt;iostream> #include &lt;string> using namespace std; int main() { string str = "string"; auto fn = [s = str + "_capture"s](string body) { cout &lt;&lt; s &lt;&lt; " : " &lt;&lt; body &lt;&lt; endl; }; fn("test"); // string_capture : test } Returning a lambda from a function #include &lt;iostream> using namespace std; auto getAdd(int n) { return [n](int an) { return n + an; }; } int main() { auto fn = getAdd(10); cout &lt;&lt; fn(20) &lt;&lt; endl; } C++17 Constexpr #include &lt;iostream> using namespace std; int main() { constexpr auto fn = [](int n){ return n + 10; }; static_assert(fn(10) == 20); // ok static_assert(fn(20) == 20); // error: static assertion failed } Capturing a copy of *this this ì°¸ì¡°ì— ìº¡ì³ê°€ ì•„ë‹Œ, *this ë³µì‚¬ë³¸ ìº¡ì³ #include &lt;iostream> #include &lt;memory> #include &lt;tuple> using namespace std; class item { public: item(int n = 0) : _value(n) {} auto test() { _value += 1; // copy capture auto fn1 = [*this] { return _value; }; auto fn2 = [self = *this] { return self._value; }; // ref capture auto fn3 = [this] { return _value; }; _value += 1; fn1(); // 11 fn2(); // 11 fn3(); // 12 return make_tuple(fn1, fn2, fn3); } private: int _value; }; int main() { auto it = make_shared&lt;item>(10); auto tp = it->test(); it.reset(); cout &lt;&lt; get&lt;0>(tp)() &lt;&lt; endl; cout &lt;&lt; get&lt;1>(tp)() &lt;&lt; endl; cout &lt;&lt; get&lt;2>(tp)() &lt;&lt; endl; // ref memory error } C++20 Template syntax for lambdas #include &lt;iostream> #include &lt;vector> using namespace std; int main() { auto fn = []&lt;typename T>(vector&lt;T> &amp;v) { return v.size(); }; vector&lt;int> v = {1, 2, 3, 4, 5}; cout &lt;&lt; fn(v) &lt;&lt; endl; } Lambda capture of parameter pack #include &lt;iostream> #include &lt;string> using namespace std; template &lt;typename... Args> auto getAddFunc(Args&&... args){ // by ref [&...args = std::forward&lt;Args>(args)] // by value return [...args = std::forward&lt;Args>(args)] (auto && init) { return init + (args + ...); }; } int main() { auto fn = getAddFunc(1, 2, 3); cout &lt;&lt; fn(10) &lt;&lt; endl; // 16 auto fns = getAddFunc("this "s, "is "s, "sample"s); cout &lt;&lt; fns("note: "s) &lt;&lt; endl; // note: this is sample }</p></div><footer class=entry-footer><span title='2021-12-14 00:00:00 +0900 KST'>December 14, 2021</span>&nbsp;Â·&nbsp;<span>Byung Kyu KIM</span></footer><a class=entry-link aria-label="post link to C++ Lambda í‘œí˜„ì‹" href=https://cdecl.github.io/dev/c++-lambda/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>MinIO Windows Service ë“±ë¡</h2></header><div class=entry-content><p>MinIO Windows Service ë“±ë¡
MinIO Service ë“±ë¡ WinSW https://github.com/winsw/winsw{:target="_blank"} Windows ì‹¤í–‰ íŒŒì¼ì„ ì„œë¹„ìŠ¤ë¡œ ë˜í•‘í•´ì£¼ëŠ” íˆ´ .NET Framework / Core ê¸°ë°˜ Windows í”Œë«í¼ì—ì„œ ì‹¤í–‰ MinIO Service https://github.com/minio/minio-service/tree/master/windows{:target="_blank"} WinSW ìµœì‹  Release ë‹¤ìš´ë¡œë“œ ë° XML ì„¤ì • íŒŒì¼ ì‘ì„± # choco install curl # ë‹¤ìš´ë¡œë“œ $ curl -LO https://github.com/winsw/winsw/releases/download/v2.11.0/WinSW-x64.exe # rename $ move WinSW-x64.exe minio-service.exe minio-service.xml &lt;service> &lt;id>MinIO&lt;/id> &lt;name>MinIO&lt;/name> &lt;description>MinIO is a high performance object storage server&lt;/description> &lt;executable>minio.exe&lt;/executable> &lt;env name="MINIO_ROOT_USER" value="minio"/> &lt;env name="MINIO_ROOT_PASSWORD" value="minio1234"/> &lt;arguments>server d:\minio\data --console-address ":9001"&lt;/arguments> &lt;logmode>rotate&lt;/logmode> &lt;/service> ì„œë¹„ìŠ¤ ë“±ë¡ Administrator ê¶Œí•œìœ¼ë¡œ ì‹¤í–‰ minio ì‹¤í–‰ íŒŒì¼ PATH ë“±ë¡ or ê°™ì€ ë””ë ‰í† ë¦¬ì— ìœ„ì¹˜ # service install $ minio-service.exe install 2021-12-09 15:57:24,987 INFO - Installing service 'MinIO (MinIO)'... 2021-12-09 15:57:25,085 INFO - Service 'MinIO (MinIO)' was installed successfully. # service status $ minio-service.exe status Stopped # service start $ minio-service.exe start 2021-12-09 16:05:59,133 INFO - Starting service 'MinIO (MinIO)'... 2021-12-09 16:06:00,322 INFO - Service 'MinIO (MinIO)' started successfully.</p></div><footer class=entry-footer><span title='2021-12-10 00:00:00 +0900 KST'>December 10, 2021</span>&nbsp;Â·&nbsp;<span>Byung Kyu KIM</span></footer><a class=entry-link aria-label="post link to MinIO Windows Service ë“±ë¡" href=https://cdecl.github.io/devops/minio-windows-service/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Rclone Basic</h2></header><div class=entry-content><p>Go ì–¸ì–´ë¡œ ë§Œë“  í¬ë¡œìŠ¤ í”Œë«í¼ í´ë¼ìš°ë“œ ìŠ¤í† ë¦¬ì§€ íŠ¹í™” ë°±ì—… ë° ë™ê¸°í™” í”„ë¡œê·¸ë¨
Rclone https://rclone.org/{:target="_blank"} file, sftp ë¶€í„° Amazon S3, MinIO ì™€ ê°™ì€ Object Storage, Cloud Storage ë“±ì˜ ë§ì€ Providers ë¥¼ ì§€ì› Install í”Œë«í¼ ë°”ì´ë„ˆë¦¬ ë‹¤ìš´ë¡œë“œ or íŒ¨í‚¤ì§€ ë§¤ë‹ˆì € í™œìš© https://rclone.org/downloads/{:target="_blank"} Rclone config Providers ì„¤ì • ê¸°ë°˜, config íŒŒì¼ì„ í†µí•´ ì„¤ì • Rclone config ê¸°ë³¸ íŒŒì¼ ìœ„ì¹˜ í™•ì¸ # linux config íŒŒì¼ ìœ„ì¹˜ í™•ì¸ $ rclone config file Configuration file is stored at: /home/&lt;HOME>/.config/rclone/rclone.conf # windows $ rclone config file Configuration file is stored at: C:\Users\&lt;HOME>\AppData\Roaming\rclone\rclone.conf Rclone config ì¶”ê°€ config íŒŒì¼ì„ ì§ì ‘ ìˆ˜ì • í•˜ê±°ë‚˜ Interactive í™”ë©´ì„ í†µí•´ ì§„í–‰ $ rclone config No remotes found - make a new one n) New remote s) Set configuration password q) Quit config n/s/q> ... Rclone config ë‚´ìš© í™•ì¸ $ rclone config show Rclone Provider config Amazon S3 [mys3] type = s3 provider = AWS env_auth = true region = ap-northeast-2 location_constraint = ap-northeast-2 [mys3] type = s3 provider = AWS env_auth = true region = ap-northeast-2 location_constraint = ap-northeast-2 access_key_id = AKIAXXXXXXXXXXXXXXXX secret_access_key = 1oxxxxxxxxxxxxxxxxxxxxxxxxx MinIO [myminio] type = s3 provider = Minio env_auth = false access_key_id = KEYxxxxxxxxx secret_access_key = PWDxxxxxxxxx endpoint = http://minio-server SFTP ê³µê°œí‚¤ ì¸ì¦ì„ ìœ„í•´ key_file ì§€ì •í•˜ì§€ ì•Šìœ¼ë©´ ssh_agentë¥¼ í†µí•´ ì ‘ê·¼ì‹œë„
...</p></div><footer class=entry-footer><span title='2021-12-09 00:00:00 +0900 KST'>December 9, 2021</span>&nbsp;Â·&nbsp;<span>Byung Kyu KIM</span></footer><a class=entry-link aria-label="post link to Rclone Basic" href=https://cdecl.github.io/devops/rclone-101/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Golang GC</h2></header><div class=entry-content><p>Golang GC (ê°€ë¹„ì§€ ì»¬ë ‰í„°) ì£¼ìš” ë‚´ìš©
Golang GC : GOGC ìœ íš¨í•˜ì§€ ì•ŠëŠ” ë©”ëª¨ë¦¬(Dangling Object)ë¥¼ ì£¼ê¸°ì ìœ¼ë¡œ í•´ì œí•˜ëŠ” ê¸°ë²• Javaì˜ Parallel GC, G1GC ì™€ ìœ ì‚¬í•˜ë‚˜ êµ¬í˜„ ë°©ì‹ì—ì„œ ì°¨ì´ê°€ ìˆìŒ Stop-the-World ì‹œê°„ì„ ìµœì†Œí™”í•˜ë„ë¡ ì„¤ê³„ë¨ Tri-Color Algorithm ì‚¬ìš© ë™ì‹œì„±ì„ ê³ ë ¤í•œ íš¨ìœ¨ì ì¸ ë©”ëª¨ë¦¬ ê´€ë¦¬ ì•Œê³ ë¦¬ì¦˜ CMS (Concurrent Mark and Sweep) ë°©ì‹ ìš´ì˜ Java ì™€ ê°™ì€ Generation GC ê¸°ë²•ì´ë‚˜ Compactionì€ ì§€ì›í•˜ì§€ ì•ŠìŒ ëŒ€ì‹  ë” íš¨ìœ¨ì ì¸ ë©”ëª¨ë¦¬ í• ë‹¹ ì „ëµì„ ì‚¬ìš© Compaction (ì••ì¶•, ì¬ë°°ì¹˜) ê°€ ì—†ìŒ ì¬ë°°ì¹˜ë¥¼ í•˜ì§€ ì•ŠëŠ” ëŒ€ì‹  TCMallocë¥¼ í†µí•œ ë©”ëª¨ë¦¬ í• ë‹¹ ê´€ë¦¬ ë©”ëª¨ë¦¬ ë‹¨í¸í™”ë¥¼ ìµœì†Œí™”í•˜ê³  ë¹ ë¥¸ í• ë‹¹ì„ ì§€ì› ë©€í‹°ì“°ë ˆë“œ ìµœì í™” í™ ë©”ëª¨ë¦¬ í• ë‹¹ê¸° - tcmalloc. jemalloc{:target="_blank"} Tri-Color Algorithm ë™ì‘ ì›ë¦¬ white, black, grey ì„¸ ê°€ì§€ ìƒíƒœë¥¼ í†µí•œ ë©”ëª¨ë¦¬ ê´€ë¦¬
...</p></div><footer class=entry-footer><span title='2021-12-01 00:00:00 +0900 KST'>December 1, 2021</span>&nbsp;Â·&nbsp;<span>Byung Kyu KIM</span></footer><a class=entry-link aria-label="post link to Golang GC" href=https://cdecl.github.io/dev/golang-gogc/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Restic Basic</h2></header><div class=entry-content><p>Snapshots ê¸°ëŠ¥ì„ ì œê³µí•˜ëŠ” modern backup program
restic https://restic.net/{:target="_blank"} Goë¡œ ë§Œë“¤ì–´ì§„ ë°±ì—… í”„ë¡œê·¸ë¨, í¬ë¡œìŠ¤í”„ë«í¼ ì§€ì› - from Linux, BSD, Mac and Windows - to many different storage types, including self-hosted and online services - easily, being a single executable that you can run without a server or complex setup - effectively, only transferring the parts that actually changed in the files you back up - securely, by careful use of cryptography in every part of the process - verifiably, enabling you to make sure that your files can be restored when needed - freely - restic is entirely free to use and completely open source Install Package ì„¤ì¹˜ ë° Binary ì§€ì› Package : https://restic.readthedocs.io/en/stable/020_installation.html{:target="_blank"} Binary : https://github.com/restic/restic/releases/tag/v0.12.1{:target="_blank"} $ curl -LO https://github.com/restic/restic/releases/download/v0.12.1/restic_0.12.1_linux_amd64.bz2 # install bzip2 $ sudo yum install bzip2 -y $ bunzip2 restic_0.12.1_linux_amd64.bz2 $ mv restic_0.12.1_linux_amd64 restic $ sudo mv restic /usr/local/bin $ restic restic is a backup program which allows saving multiple revisions of files and directories in an encrypted repository stored on different backends. Usage: restic [command] Available Commands: backup Create a new backup of files and/or directories cache Operate on local cache directories cat Print internal objects to stdout check Check the repository for errors copy Copy snapshots from one repository to another diff Show differences between two snapshots dump Print a backed-up file to stdout find Find a file, a directory or restic IDs forget Remove snapshots from the repository generate Generate manual pages and auto-completion files (bash, fish, zsh) help Help about any command init Initialize a new repository key Manage keys (passwords) list List objects in the repository ls List files in a snapshot migrate Apply migrations mount Mount the repository prune Remove unneeded data from the repository rebuild-index Build a new index recover Recover data from the repository restore Extract the data from a snapshot self-update Update the restic binary snapshots List all snapshots stats Scan the repository and show basic statistics tag Modify tags on snapshots unlock Remove locks other processes created version Print version information .... Backup & Restore Backup Repository ìƒì„± # Repository ì ‘ê·¼ì„ ìœ„í•œ íŒ¨ë“œì›ŒìŠ¤ í•„ìš”, ì¼ë‹¨ 1111 # -r, --repo repository repository to backup to or restore from (default: $RESTIC_REPOSITORY) $ restic init -r repo enter password for new repository: enter password again: created restic repository 7f3cfb3e9a at repo Please note that knowledge of your password is required to access the repository. Losing your password means that your data is irrecoverably lost. # password íŒŒì¼ ìƒì„±, -p ì˜µì…˜ìœ¼ë¡œ ì§€ì • $ echo 1111 > passwd Backup : snapshots ìƒì„± # Backup # restic -r &lt;repository> -p &lt;passwd file> backup &lt;Source> # -p, --password-file file file to read the repository password from (default: $RESTIC_PASSWORD_FILE) $ restic -r repo -p passwd backup /home/cdecl/temp/mvcapp repository e4ccc49d opened successfully, password is correct no parent snapshot found, will read all files Files: 79 new, 0 changed, 0 unmodified Dirs: 40 new, 0 changed, 0 unmodified Added to the repo: 4.854 MiB processed 79 files, 4.811 MiB in 0:00 snapshot 9aff8447 saved # íŒŒì¼ìƒì„± ë° ë‹¤ì‹œë°±ì—… $ touch /home/cdecl/temp/mvcapp/test.txt $ restic -r repo -p passwd backup /home/cdecl/temp/mvcapp repository e4ccc49d opened successfully, password is correct using parent snapshot 9aff8447 Files: 1 new, 0 changed, 79 unmodified Dirs: 0 new, 4 changed, 36 unmodified Added to the repo: 7.742 KiB processed 80 files, 4.811 MiB in 0:00 snapshot f4b94d9b saved Snapshots í™•ì¸ # snapshots 2ê°œ í™”ì¸ í™•ì¸ $ restic -r repo -p passwd snapshots repository e4ccc49d opened successfully, password is correct ID Time Host Tags Paths ------------------------------------------------------------------------------ 9aff8447 2021-11-25 15:17:52 centos1 /home/cdecl/temp/mvcapp f4b94d9b 2021-11-25 15:22:24 centos1 /home/cdecl/temp/mvcapp ------------------------------------------------------------------------------ 2 snapshots Snapshots ë¹„êµ $ restic -r repo -p passwd diff 9aff8447 f4b94d9b repository e4ccc49d opened successfully, password is correct comparing snapshot 9aff8447 to f4b94d9b: + /home/cdecl/temp/mvcapp/test.txt Files: 1 new, 0 removed, 0 changed Dirs: 0 new, 0 removed Others: 0 new, 0 removed Data Blobs: 0 new, 0 removed Tree Blobs: 5 new, 5 removed Added: 7.742 KiB Removed: 7.456 KiB Restore : Snapshots ì—ì„œ ë³µì› # restic -r &lt;repository> -p &lt;passwd file> restore &lt;snapshots id> -t &lt;Target> $ restic -r repo -p passwd restore 9aff8447 -t restore-mvcapp repository e4ccc49d opened successfully, password is correct restoring &lt;Snapshot 9aff8447 of [/home/cdecl/temp/mvcapp] at 2021-11-25 15:17:52.115925352 +0900 KST by cdecl@centos1> to restore-mvcapp MinIO & RClone Backend ì§€ì› https://restic.readthedocs.io/en/stable/030_preparing_a_new_repo.html{:target="_blank"} Local, SFTP, REST Server, Amazon S3, Minio Server, Microsoft Azure Blob Storage, Google Cloud Storage, Other Services via rclone ë“± ì§€ì› MinIO Repository ë§Œë“¤ê¸° $ export AWS_ACCESS_KEY_ID=key $ export AWS_SECRET_ACCESS_KEY=passwd $ restic init -r s3:http://minio.server:9000/restic enter password for new repository: enter password again: created restic repository 65a27250da at s3:http://minio.server:9000/restic Please note that knowledge of your password is required to access the repository. Losing your password means that your data is irrecoverably lost. # Backup $ restic -r s3:http://minio.server:9000/restic -p passwd backup /home/cdecl/temp/mvcapp # snapshots $ restic -r s3:http://minio.server:9000/restic -p passwd snapshots repository 65a27250 opened successfully, password is correct ID Time Host Tags Paths ------------------------------------------------------------------------------ 73d37fbd 2021-11-25 15:37:34 centos1 /home/cdecl/temp/mvcapp ------------------------------------------------------------------------------ 1 snapshots RClone Backend ë¡œ ì‚¬ìš© $ rclone config show [infradb] type = s3 env_auth = false access_key_id = key secret_access_key = passwd region = us-east-1 endpoint = http://minio.server:9000 # rclone config ì‚¬ìš© respository ë§Œë“¤ê¸° $ restic init -r rclone:infradb:restic enter password for new repository: enter password again: created restic repository ce850667c9 at rclone:infradb:restic Please note that knowledge of your password is required to access the repository. Losing your password means that your data is irrecoverably lost. # Backup $ restic -r rclone:infradb:restic -p passwd backup /home/cdecl/temp/mvcapp # snapshots $ restic -r rclone:infradb:restic -p passwd snapshots Snapshots ê´€ë¦¬ https://restic.readthedocs.io/en/stable/060_forget.html{:target="_blank"} $ restic -r rclone:infradb:restic -p passwd snapshots repository ce850667 opened successfully, password is correct ID Time Host Tags Paths ------------------------------------------------------------------------------ a3737738 2021-11-25 15:44:05 centos1 /home/cdecl/temp/mvcapp 00f16d70 2021-11-25 15:44:50 centos1 /home/cdecl/temp/mvcapp 0e83568a 2021-11-25 15:44:51 centos1 /home/cdecl/temp/mvcapp 4041e3ca 2021-11-25 15:44:53 centos1 /home/cdecl/temp/mvcapp eb1e56c7 2021-11-25 15:44:54 centos1 /home/cdecl/temp/mvcapp d81b3d2a 2021-11-25 15:44:55 centos1 /home/cdecl/temp/mvcapp ------------------------------------------------------------------------------ 6 snapshots # snapshots 1ê°œ ì§€ìš°ê¸° $ restic -r rclone:infradb:restic -p passwd forget d81b3d2a repository ce850667 opened successfully, password is correct [0:00] 100.00% 1 / 1 files deleted # ìŠ¤ëƒ…ìƒ·ì˜ íŒŒì¼ì—ì„œ ì°¸ì¡°í•œ ë°ì´í„°ëŠ” ì—¬ì „íˆ ì €ì¥ì†Œì— ì €ì¥ # ì°¸ì¡°ë˜ì§€ ì•Šì€ ë°ì´í„°ë¥¼ ì •ë¦¬í•˜ë ¤ë©´ prune ëª…ë ¹ ì‹¤í–‰ $ restic -r rclone:infradb:restic -p passwd prune repository ce850667 opened successfully, password is correct loading indexes... loading all snapshots... finding data that is still in use for 5 snapshots [0:00] 100.00% 5 / 5 snapshots searching used packs... collecting packs for deletion and repacking [0:00] 100.00% 9 / 9 packs processed to repack: 0 blobs / 0 B this removes 0 blobs / 0 B to delete: 2 blobs / 1004 B total prune: 2 blobs / 1004 B remaining: 125 blobs / 4.862 MiB unused size after prune: 0 B (0.00% of remaining size) rebuilding index [0:00] 100.00% 8 / 8 packs processed deleting obsolete index files [0:00] 100.00% 6 / 6 files deleted removing 1 old packs [0:00] 100.00% 1 / 1 files deleted done # ìµœê·¼ 1ê°œë§Œ ë†”ë‘ê³  snapshots ì‚­ì œ ë° prune $ restic -r rclone:infradb:restic -p passwd forget --keep-last 1 --prune repository ce850667 opened successfully, password is correct Applying Policy: keep 1 latest snapshots keep 1 snapshots: ID Time Host Tags Reasons Paths --------------------------------------------------------------------------------------------- eb1e56c7 2021-11-25 15:44:54 centos1 last snapshot /home/cdecl/temp/mvcapp --------------------------------------------------------------------------------------------- 1 snapshots remove 4 snapshots: ID Time Host Tags Paths ------------------------------------------------------------------------------ a3737738 2021-11-25 15:44:05 centos1 /home/cdecl/temp/mvcapp 00f16d70 2021-11-25 15:44:50 centos1 /home/cdecl/temp/mvcapp 0e83568a 2021-11-25 15:44:51 centos1 /home/cdecl/temp/mvcapp 4041e3ca 2021-11-25 15:44:53 centos1 /home/cdecl/temp/mvcapp ------------------------------------------------------------------------------ 4 snapshots [0:00] 100.00% 4 / 4 files deleted 4 snapshots have been removed, running prune loading indexes... loading all snapshots... finding data that is still in use for 1 snapshots [0:00] 100.00% 1 / 1 snapshots searching used packs... collecting packs for deletion and repacking [0:00] 100.00% 8 / 8 packs processed to repack: 39 blobs / 47.305 KiB this removes 2 blobs / 1007 B to delete: 6 blobs / 2.950 KiB total prune: 8 blobs / 3.934 KiB remaining: 117 blobs / 4.858 MiB unused size after prune: 0 B (0.00% of remaining size) repacking packs [0:00] 100.00% 2 / 2 packs repacked rebuilding index [0:00] 100.00% 5 / 5 packs processed deleting obsolete index files [0:00] 100.00% 1 / 1 files deleted removing 5 old packs [0:00] 100.00% 5 / 5 files deleted done # snapshots í™•ì¸ $ restic -r rclone:infradb:restic -p passwd snapshots repository ce850667 opened successfully, password is correct ID Time Host Tags Paths ------------------------------------------------------------------------------ eb1e56c7 2021-11-25 15:44:54 centos1 /home/cdecl/temp/mvcapp ------------------------------------------------------------------------------ 1 snapshots forget ì£¼ìš” ì¸ìˆ˜ --keep-last n never delete the n last (most recent) snapshots --keep-hourly n for the last n hours in which a snapshot was made, keep only the last snapshot for each hour. --keep-daily n for the last n days which have one or more snapshots, only keep the last one for that day. --keep-weekly n for the last n weeks which have one or more snapshots, only keep the last one for that week. --keep-monthly n for the last n months which have one or more snapshots, only keep the last one for that month. --keep-yearly n for the last n years which have one or more snapshots, only keep the last one for that year. --keep-tag keep all snapshots which have all tags specified by this option (can be specified multiple times).</p></div><footer class=entry-footer><span title='2021-11-25 00:00:00 +0900 KST'>November 25, 2021</span>&nbsp;Â·&nbsp;<span>Byung Kyu KIM</span></footer><a class=entry-link aria-label="post link to Restic Basic" href=https://cdecl.github.io/devops/restic-basic/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>HAProxy Basic</h2></header><div class=entry-content><p>ë„¤íŠ¸ì›Œí¬ L4, L7 ê¸°ëŠ¥ Reverse proxy ë° Load balancing, HA ê¸°ëŠ¥ì„ ì œê³µí•˜ëŠ” ìµœì í™”ëœ S/W
HAProxy Basic ê³µì‹ ë¸”ë¡œê·¸ì¸ ë§Œí¼ ê°€ì¥ ì˜ ì •ë¦¬ëœ ë§í¬ë¡œ ìƒì„¸ ì„¤ëª… ëŒ€ì²´
Basic Configuration https://www.haproxy.com/blog/haproxy-configuration-basics-load-balance-your-servers/{:target="_blank"} ìµœì†Œ ì„¤ì • ë° ê¸°ë³¸ í•­ëª©ì— ëŒ€í•œ ì„¤ëª… ì„¤ì¹˜ ë° ì ìš© centos 7 # install $ sudo yum install haproxy # start $ sudo systemctl start haproxy # status $ sudo systemctl status haproxy â— haproxy.service - HAProxy Load Balancer Loaded: loaded (/usr/lib/systemd/system/haproxy.service; disabled; vendor preset: disabled) Active: active (running) since í™” 2021-11-23 13:55:48 KST; 5s ago Main PID: 227598 (haproxy-systemd) Tasks: 3 Memory: 1.9M CGroup: /system.slice/haproxy.service â”œâ”€227598 /usr/sbin/haproxy-systemd-wrapper -f /etc/haproxy/haproxy.cfg -p /run/haproxy.pid â”œâ”€227599 /usr/sbin/haproxy -f /etc/haproxy/haproxy.cfg -p /run/haproxy.pid -Ds â””â”€227600 /usr/sbin/haproxy -f /etc/haproxy/haproxy.cfg -p /run/haproxy.pid -Ds ... ë²„ì „ í™•ì¸, ì§€ì› ëª¨ë“ˆ, ì§€ì› polling ì‹œìŠ¤í…œ í™•ì¸ epoll ì‚¬ìš© $ haproxy -vv HA-Proxy version 1.5.18 2016/05/10 Copyright 2000-2016 Willy Tarreau &lt;willy@haproxy.org> Build options : TARGET = linux2628 CPU = generic CC = gcc CFLAGS = -O2 -g -fno-strict-aliasing -DTCP_USER_TIMEOUT=18 OPTIONS = USE_LINUX_TPROXY=1 USE_GETADDRINFO=1 USE_ZLIB=1 USE_REGPARM=1 USE_OPENSSL=1 USE_PCRE=1 Default settings : maxconn = 2000, bufsize = 16384, maxrewrite = 8192, maxpollevents = 200 Encrypted password support via crypt(3): yes Built with zlib version : 1.2.7 Compression algorithms supported : identity, deflate, gzip Built with OpenSSL version : OpenSSL 1.0.2k-fips 26 Jan 2017 Running on OpenSSL version : OpenSSL 1.0.2k-fips 26 Jan 2017 OpenSSL library supports TLS extensions : yes OpenSSL library supports SNI : yes OpenSSL library supports prefer-server-ciphers : yes Built with PCRE version : 8.32 2012-11-30 PCRE library supports JIT : no (USE_PCRE_JIT not set) Built with transparent proxy support using: IP_TRANSPARENT IPV6_TRANSPARENT IP_FREEBIND Available polling systems : epoll : pref=300, test result OK poll : pref=200, test result OK select : pref=150, test result OK Total: 3 (3 usable), will use epoll. ê¸°ë³¸ì„¤ì • : /etc/haproxy/haproxy.cfg global : ì „ì—­ ì„¤ì • defaults : ë””í´íŠ¸ ì„¤ì • frontend : clientë¡œ ë¶€í„° ì ‘ì† ì •ë³´, 5000 Port ëŒ€ê¸° backend : ìš”ì²­ì„ ìˆ˜í–‰í•˜ëŠ” ì„œë²„ë¡œ ì „ë‹¬, 3ëŒ€ì˜ ì„œë²„ë¡œ ì „ë‹¬ listen : frontend + backend í•œêº¼ë²ˆì— ì •ë¦¬í•  ìˆ˜ ìˆëŠ” ì„¹ì…˜, Stats Monitoring UI ì„¤ì • global log 127.0.0.1 local2 chroot /var/lib/haproxy pidfile /var/run/haproxy.pid maxconn 4000 user haproxy group haproxy daemon # turn on stats unix socket stats socket /var/lib/haproxy/stats defaults mode http log global option httplog option dontlognull option http-server-close option forwardfor except 127.0.0.0/8 option redispatch retries 3 timeout http-request 10s timeout queue 1m timeout connect 10s timeout client 1m timeout server 1m timeout http-keep-alive 10s timeout check 10s maxconn 3000 listen stats bind :8404 stats enable stats uri /monitor stats refresh 5s frontend front_main bind :5000 option forwardfor default_backend app backend app balance roundrobin server app1 192.168.28.15:30010 check server app2 192.168.28.16:30010 check server app3 192.168.28.17:30010 check SSL ì¸í„°í˜ì´ìŠ¤ https://serverfault.com/questions/738045/haproxy-to-terminate-ssl-also-send-ssl-to-backend-server{:target="_blank"} Frontend SSL Bind ... frontend front_main bind :5443 ssl crt /cert/path/domain_keypem.pem option forwardfor default_backend app ... Backend SSL í˜¸ì¶œ ... backend app balance roundrobin mode http server app1 192.168.28.15:30443 ssl verify none server app2 192.168.28.16:30443 ssl verify none ... Four Essential Sections https://www.haproxy.com/blog/the-four-essential-sections-of-an-haproxy-configuration/{:target="_blank"} 4ê°œì˜ ê¸°ë³¸ ì„¹ì…˜ êµ¬ì¡° ì„¤ëª… global # global settings here defaults # defaults here frontend # a frontend that accepts requests from clients backend # servers that fulfill the requests ê¸°íƒ€ SSL ì„¤ì • : https://www.haproxy.com/blog/haproxy-ssl-termination/{:target="_blank"} í†µê³„ Web UI : https://www.haproxy.com/blog/exploring-the-haproxy-stats-page/{:target="_blank"} ...</p></div><footer class=entry-footer><span title='2021-11-22 00:00:00 +0900 KST'>November 22, 2021</span>&nbsp;Â·&nbsp;<span>Byung Kyu KIM</span></footer><a class=entry-link aria-label="post link to HAProxy Basic" href=https://cdecl.github.io/devops/haproxy-basic/></a></article><footer class=page-footer><nav class=pagination><a class=prev href=https://cdecl.github.io/page/8/>Â«&nbsp;Prev&nbsp;
</a><a class=next href=https://cdecl.github.io/page/10/>Next&nbsp;&nbsp;Â»</a></nav></footer></main><footer class=footer><span>&copy; 2026 <a href=https://cdecl.github.io/>cdeclog</a></span> Â·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");if(menu){const e=localStorage.getItem("menu-scroll-position");e&&(menu.scrollLeft=parseInt(e,10)),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}}document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{const e=document.querySelector("html");e.dataset.theme==="dark"?(e.dataset.theme="light",localStorage.setItem("pref-theme","light")):(e.dataset.theme="dark",localStorage.setItem("pref-theme","dark"))})</script></body></html>