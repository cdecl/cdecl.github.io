<!doctype html><html lang=en dir=auto data-theme=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Golang GC | cdeclog</title><meta name=keywords content="golang,gogc,tcmalloc,tri-color,gctrace"><meta name=description content='Golang GC (가비지 컬렉터) 주요 내용
Golang GC : GOGC

유효하지 않는 메모리(Dangling Object)를 주기적으로 해제하는 기법

Java의 Parallel GC, G1GC 와 유사하나 구현 방식에서 차이가 있음
Stop-the-World 시간을 최소화하도록 설계됨


Tri-Color Algorithm 사용

동시성을 고려한 효율적인 메모리 관리 알고리즘


CMS (Concurrent Mark and Sweep) 방식 운영

Java 와 같은 Generation GC 기법이나 Compaction은 지원하지 않음
대신 더 효율적인 메모리 할당 전략을 사용


Compaction (압축, 재배치) 가 없음

재배치를 하지 않는 대신 TCMalloc를 통한 메모리 할당 관리
메모리 단편화를 최소화하고 빠른 할당을 지원
멀티쓰레드 최적화 힙 메모리 할당기 - tcmalloc. jemalloc{:target="_blank"}



Tri-Color Algorithm 동작 원리
white, black, grey 세 가지 상태를 통한 메모리 관리'><meta name=author content="Byung Kyu KIM"><link rel=canonical href=https://cdecl.github.io/dev/golang-gogc/><link crossorigin=anonymous href=/assets/css/stylesheet.94cdd6e6bf254a927ddb1a5b8ae2c24a30232449c016f55d87efd0d9bed87c55.css integrity="sha256-lM3W5r8lSpJ92xpbiuLCSjAjJEnAFvVdh+/Q2b7YfFU=" rel="preload stylesheet" as=style><link rel=icon href=https://cdecl.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://cdecl.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://cdecl.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://cdecl.github.io/apple-touch-icon.png><link rel=mask-icon href=https://cdecl.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://cdecl.github.io/dev/golang-gogc/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51);color-scheme:dark}.list{background:var(--theme)}.toc{background:var(--entry)}}@media(prefers-color-scheme:light){.list::-webkit-scrollbar-thumb{border-color:var(--code-bg)}}</style></noscript><script>localStorage.getItem("pref-theme")==="dark"?document.querySelector("html").dataset.theme="dark":localStorage.getItem("pref-theme")==="light"?document.querySelector("html").dataset.theme="light":window.matchMedia("(prefers-color-scheme: dark)").matches?document.querySelector("html").dataset.theme="dark":document.querySelector("html").dataset.theme="light"</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-VQQHHYPN7K"></script><script>var doNotTrack=!1,dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes";if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-VQQHHYPN7K")}</script><meta property="og:url" content="https://cdecl.github.io/dev/golang-gogc/"><meta property="og:site_name" content="cdeclog"><meta property="og:title" content="Golang GC"><meta property="og:description" content='Golang GC (가비지 컬렉터) 주요 내용
Golang GC : GOGC 유효하지 않는 메모리(Dangling Object)를 주기적으로 해제하는 기법 Java의 Parallel GC, G1GC 와 유사하나 구현 방식에서 차이가 있음 Stop-the-World 시간을 최소화하도록 설계됨 Tri-Color Algorithm 사용 동시성을 고려한 효율적인 메모리 관리 알고리즘 CMS (Concurrent Mark and Sweep) 방식 운영 Java 와 같은 Generation GC 기법이나 Compaction은 지원하지 않음 대신 더 효율적인 메모리 할당 전략을 사용 Compaction (압축, 재배치) 가 없음 재배치를 하지 않는 대신 TCMalloc를 통한 메모리 할당 관리 메모리 단편화를 최소화하고 빠른 할당을 지원 멀티쓰레드 최적화 힙 메모리 할당기 - tcmalloc. jemalloc{:target="_blank"} Tri-Color Algorithm 동작 원리 white, black, grey 세 가지 상태를 통한 메모리 관리'><meta property="og:locale" content="ko-kr"><meta property="og:type" content="article"><meta property="article:section" content="dev"><meta property="article:published_time" content="2021-12-01T00:00:00+09:00"><meta property="article:modified_time" content="2021-12-01T00:00:00+09:00"><meta property="article:tag" content="Golang"><meta property="article:tag" content="Gogc"><meta property="article:tag" content="Tcmalloc"><meta property="article:tag" content="Tri-Color"><meta property="article:tag" content="Gctrace"><meta name=twitter:card content="summary"><meta name=twitter:title content="Golang GC"><meta name=twitter:description content='Golang GC (가비지 컬렉터) 주요 내용
Golang GC : GOGC

유효하지 않는 메모리(Dangling Object)를 주기적으로 해제하는 기법

Java의 Parallel GC, G1GC 와 유사하나 구현 방식에서 차이가 있음
Stop-the-World 시간을 최소화하도록 설계됨


Tri-Color Algorithm 사용

동시성을 고려한 효율적인 메모리 관리 알고리즘


CMS (Concurrent Mark and Sweep) 방식 운영

Java 와 같은 Generation GC 기법이나 Compaction은 지원하지 않음
대신 더 효율적인 메모리 할당 전략을 사용


Compaction (압축, 재배치) 가 없음

재배치를 하지 않는 대신 TCMalloc를 통한 메모리 할당 관리
메모리 단편화를 최소화하고 빠른 할당을 지원
멀티쓰레드 최적화 힙 메모리 할당기 - tcmalloc. jemalloc{:target="_blank"}



Tri-Color Algorithm 동작 원리
white, black, grey 세 가지 상태를 통한 메모리 관리'><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Devs","item":"https://cdecl.github.io/dev/"},{"@type":"ListItem","position":2,"name":"Golang GC","item":"https://cdecl.github.io/dev/golang-gogc/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Golang GC","name":"Golang GC","description":"Golang GC (가비지 컬렉터) 주요 내용\nGolang GC : GOGC 유효하지 않는 메모리(Dangling Object)를 주기적으로 해제하는 기법 Java의 Parallel GC, G1GC 와 유사하나 구현 방식에서 차이가 있음 Stop-the-World 시간을 최소화하도록 설계됨 Tri-Color Algorithm 사용 동시성을 고려한 효율적인 메모리 관리 알고리즘 CMS (Concurrent Mark and Sweep) 방식 운영 Java 와 같은 Generation GC 기법이나 Compaction은 지원하지 않음 대신 더 효율적인 메모리 할당 전략을 사용 Compaction (압축, 재배치) 가 없음 재배치를 하지 않는 대신 TCMalloc를 통한 메모리 할당 관리 메모리 단편화를 최소화하고 빠른 할당을 지원 멀티쓰레드 최적화 힙 메모리 할당기 - tcmalloc. jemalloc{:target=\u0026quot;_blank\u0026quot;} Tri-Color Algorithm 동작 원리 white, black, grey 세 가지 상태를 통한 메모리 관리\n","keywords":["golang","gogc","tcmalloc","tri-color","gctrace"],"articleBody":"Golang GC (가비지 컬렉터) 주요 내용\nGolang GC : GOGC 유효하지 않는 메모리(Dangling Object)를 주기적으로 해제하는 기법 Java의 Parallel GC, G1GC 와 유사하나 구현 방식에서 차이가 있음 Stop-the-World 시간을 최소화하도록 설계됨 Tri-Color Algorithm 사용 동시성을 고려한 효율적인 메모리 관리 알고리즘 CMS (Concurrent Mark and Sweep) 방식 운영 Java 와 같은 Generation GC 기법이나 Compaction은 지원하지 않음 대신 더 효율적인 메모리 할당 전략을 사용 Compaction (압축, 재배치) 가 없음 재배치를 하지 않는 대신 TCMalloc를 통한 메모리 할당 관리 메모리 단편화를 최소화하고 빠른 할당을 지원 멀티쓰레드 최적화 힙 메모리 할당기 - tcmalloc. jemalloc{:target=\"_blank\"} Tri-Color Algorithm 동작 원리 white, black, grey 세 가지 상태를 통한 메모리 관리\n초기 단계\n모든 메모리 객체를 white 상태로 설정 이는 잠재적으로 수집 가능한 상태를 의미 마킹 단계\nGC Root에서 직접 참조하는 객체들을 grey로 표시 grey 객체들은 검사가 필요한 상태를 의미 스캐닝 단계\ngrey 상태 객체가 참조하는 다른 객체들을 grey로 표시 검사가 완료된 객체는 black으로 변경 이 과정을 grey 객체가 없을 때까지 반복 수집 단계\n남아있는 white 상태의 객체들을 메모리에서 해제 이 객체들은 더 이상 접근할 수 없는(unreachable) 상태 TCMalloc (Thread-Caching Malloc) Google이 개발한 고성능 메모리 할당기\n특징:\nThread 별 캐시를 통한 빠른 메모리 할당 크기별로 최적화된 할당 전략 사용 메모리 단편화 최소화 Lock contention 감소로 인한 성능 향상 장점:\n멀티스레드 환경에서 우수한 성능 메모리 재사용 최적화 캐시 지역성 향상 할당/해제 오버헤드 감소 GOGC 옵션 가비지 컬렉션 대상 백분율 설정\n이전 수집 후 남은 라이브 데이터에 대한 새로 할당된 데이터의 비율을 조정\nGOGC=100 : 기본값, 100% 비율 힙이 라이브 메모리의 100%만큼 증가하면 GC 트리거 GOGC=50 : GC를 더 자주 실행 메모리 사용량은 줄지만 CPU 사용량 증가 GOGC=200 : GC를 덜 자주 실행 CPU 사용량은 줄지만 메모리 사용량 증가 GOGC=off : GC를 사용하지 않음 특수한 경우에만 사용 (벤치마크, 테스트 등) GC Trace 활용 gctrace 옵션을 통한 가비지 컬렉션 모니터링\n예제 코드 package main import ( \"fmt\" \"sync\" \"time\" ) type log struct { Info string Seq int } func main() { wg := sync.WaitGroup{} for i := 0; i \u003c 1000000; i++ { wg.Add(1) go func() { defer wg.Done() info := fmt.Sprintf(\"test %d\", i) _ = log{info, i} // fmt.Println(s, t) time.Sleep(time.Millisecond * 1000) }() } wg.Wait() } 실행 및 모니터링 # 프로젝트 초기화 $ go mod init gctest $ go mod tidy # build $ go build 실행 테스트 # GODEBUG=gctrace=1 : gctrace 활성화 $ GODEBUG=gctrace=1 ./gctest 트레이스 출력 분석 gc 1 @0.010s 9%: 0.058+2.6+0.083 ms clock, 0.46+6.6/2.9/0+0.66 ms cpu, 4-\u003e5-\u003e4 MB, 5 MB goal, 8 P gc 2 @0.015s 19%: 0.093+4.7+0.17 ms clock, 0.74+14/6.1/0+1.4 ms cpu, 6-\u003e7-\u003e6 MB, 8 MB goal, 8 P gc 3 @0.027s 25%: 0.15+5.7+0.34 ms clock, 1.2+22/9.0/0+2.7 ms cpu, 10-\u003e13-\u003e11 MB, 13 MB goal, 8 P gc 4 @0.044s 29%: 0.084+11+0.35 ms clock, 0.67+45/18/0+2.8 ms cpu, 18-\u003e22-\u003e20 MB, 23 MB goal, 8 P gc 5 @0.076s 31%: 0.24+17+0.19 ms clock, 1.9+66/31/0+1.5 ms cpu, 32-\u003e37-\u003e34 MB, 40 MB goal, 8 P gc 6 @0.129s 33%: 0.13+26+0.065 ms clock, 1.1+124/50/4.6+0.52 ms cpu, 54-\u003e62-\u003e58 MB, 68 MB goal, 8 P gc 7 @0.214s 34%: 0.095+40+0.099 ms clock, 0.76+204/79/0.34+0.79 ms cpu, 93-\u003e98-\u003e91 MB, 116 MB goal, 8 P gc 8 @0.355s 35%: 0.086+66+0.12 ms clock, 0.69+375/132/0+0.99 ms cpu, 152-\u003e158-\u003e144 MB, 182 MB goal, 8 P gc 9 @0.605s 35%: 0.11+109+0.087 ms clock, 0.88+624/216/0+0.70 ms cpu, 252-\u003e261-\u003e242 MB, 289 MB goal, 8 P gc 10 @1.033s 35%: 0.077+206+1.0 ms clock, 0.61+1021/397/0.93+8.1 ms cpu, 430-\u003e437-\u003e403 MB, 484 MB goal, 8 P 출력 항목 설명: gc 1: GC 실행 번호 @0.010s: 프로그램 시작 후 경과 시간 9%: GC에 사용된 CPU 시간 비율 0.058+2.6+0.083 ms: 각 GC 단계별 소요 시간 4-\u003e5-\u003e4 MB: GC 전후의 힙 크기 변화 5 MB goal: 목표 힙 크기 8 P: 사용된 프로세서 수 ","wordCount":"597","inLanguage":"en","datePublished":"2021-12-01T00:00:00+09:00","dateModified":"2021-12-01T00:00:00+09:00","author":{"@type":"Person","name":"Byung Kyu KIM"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://cdecl.github.io/dev/golang-gogc/"},"publisher":{"@type":"Organization","name":"cdeclog","logo":{"@type":"ImageObject","url":"https://cdecl.github.io/favicon.ico"}}}</script></head><body id=top><header class=header><nav class=nav><div class=logo><a href=https://cdecl.github.io/ accesskey=h title="cdeclog (Alt + H)">cdeclog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://cdecl.github.io/dev/ title=Dev><span>Dev</span></a></li><li><a href=https://cdecl.github.io/devops/ title=DevOps><span>DevOps</span></a></li><li><a href=https://cdecl.github.io/archives/ title=Archive><span>Archive</span></a></li><li><a href=https://cdecl.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://cdecl.github.io/tags/ title=Tags><span>Tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">Golang GC</h1><div class=post-meta><span title='2021-12-01 00:00:00 +0900 KST'>December 1, 2021</span>&nbsp;·&nbsp;<span>Byung Kyu KIM</span></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#golang-gc--gogc aria-label="Golang GC : GOGC">Golang GC : GOGC</a><ul><li><a href=#tri-color-algorithm-%eb%8f%99%ec%9e%91-%ec%9b%90%eb%a6%ac aria-label="Tri-Color Algorithm 동작 원리">Tri-Color Algorithm 동작 원리</a></li><li><a href=#tcmalloc-thread-caching-malloc aria-label="TCMalloc (Thread-Caching Malloc)">TCMalloc (Thread-Caching Malloc)</a></li><li><a href=#gogc-%ec%98%b5%ec%85%98 aria-label="GOGC 옵션">GOGC 옵션</a></li><li><a href=#gc-trace-%ed%99%9c%ec%9a%a9 aria-label="GC Trace 활용">GC Trace 활용</a><ul><li><a href=#%ec%98%88%ec%a0%9c-%ec%bd%94%eb%93%9c aria-label="예제 코드">예제 코드</a></li><li><a href=#%ec%8b%a4%ed%96%89-%eb%b0%8f-%eb%aa%a8%eb%8b%88%ed%84%b0%eb%a7%81 aria-label="실행 및 모니터링">실행 및 모니터링</a><ul><li><a href=#%ec%8b%a4%ed%96%89-%ed%85%8c%ec%8a%a4%ed%8a%b8 aria-label="실행 테스트">실행 테스트</a></li></ul></li><li><a href=#%ed%8a%b8%eb%a0%88%ec%9d%b4%ec%8a%a4-%ec%b6%9c%eb%a0%a5-%eb%b6%84%ec%84%9d aria-label="트레이스 출력 분석">트레이스 출력 분석</a></li><li><a href=#%ec%b6%9c%eb%a0%a5-%ed%95%ad%eb%aa%a9-%ec%84%a4%eb%aa%85 aria-label="출력 항목 설명:">출력 항목 설명:</a></li></ul></li></ul></li></ul></div></details></div><div class=post-content><p>Golang GC (가비지 컬렉터) 주요 내용</p><h2 id=golang-gc--gogc>Golang GC : <code>GOGC</code><a hidden class=anchor aria-hidden=true href=#golang-gc--gogc>#</a></h2><ul><li>유효하지 않는 메모리(Dangling Object)를 주기적으로 해제하는 기법<ul><li>Java의 <code>Parallel GC</code>, <code>G1GC</code> 와 유사하나 구현 방식에서 차이가 있음</li><li>Stop-the-World 시간을 최소화하도록 설계됨</li></ul></li><li>Tri-Color Algorithm 사용<ul><li>동시성을 고려한 효율적인 메모리 관리 알고리즘</li></ul></li><li>CMS (Concurrent Mark and Sweep) 방식 운영<ul><li>Java 와 같은 Generation GC 기법이나 Compaction은 지원하지 않음</li><li>대신 더 효율적인 메모리 할당 전략을 사용</li></ul></li><li>Compaction (압축, 재배치) 가 없음<ul><li>재배치를 하지 않는 대신 <code>TCMalloc</code>를 통한 메모리 할당 관리</li><li>메모리 단편화를 최소화하고 빠른 할당을 지원</li><li><a href=https://cdecl.net/304>멀티쓰레드 최적화 힙 메모리 할당기 - tcmalloc. jemalloc</a>{:target="_blank"}</li></ul></li></ul><h3 id=tri-color-algorithm-동작-원리>Tri-Color Algorithm 동작 원리<a hidden class=anchor aria-hidden=true href=#tri-color-algorithm-동작-원리>#</a></h3><p><code>white</code>, <code>black</code>, <code>grey</code> 세 가지 상태를 통한 메모리 관리</p><ol><li><p>초기 단계</p><ul><li>모든 메모리 객체를 <code>white</code> 상태로 설정</li><li>이는 잠재적으로 수집 가능한 상태를 의미</li></ul></li><li><p>마킹 단계</p><ul><li><code>GC Root</code>에서 직접 참조하는 객체들을 <code>grey</code>로 표시</li><li><code>grey</code> 객체들은 검사가 필요한 상태를 의미</li></ul></li><li><p>스캐닝 단계</p><ul><li><code>grey</code> 상태 객체가 참조하는 다른 객체들을 <code>grey</code>로 표시</li><li>검사가 완료된 객체는 <code>black</code>으로 변경</li><li>이 과정을 grey 객체가 없을 때까지 반복</li></ul></li><li><p>수집 단계</p><ul><li>남아있는 <code>white</code> 상태의 객체들을 메모리에서 해제</li><li>이 객체들은 더 이상 접근할 수 없는(unreachable) 상태</li></ul></li></ol><p><img alt="Tri-Color Mark and Sweep" loading=lazy src=/images/2021-12-02-10-43-45.png></p><h3 id=tcmalloc-thread-caching-malloc>TCMalloc (Thread-Caching Malloc)<a hidden class=anchor aria-hidden=true href=#tcmalloc-thread-caching-malloc>#</a></h3><ul><li><p>Google이 개발한 고성능 메모리 할당기</p></li><li><p>특징:</p><ul><li>Thread 별 캐시를 통한 빠른 메모리 할당</li><li>크기별로 최적화된 할당 전략 사용</li><li>메모리 단편화 최소화</li><li>Lock contention 감소로 인한 성능 향상</li></ul></li><li><p>장점:</p><ul><li>멀티스레드 환경에서 우수한 성능</li><li>메모리 재사용 최적화</li><li>캐시 지역성 향상</li><li>할당/해제 오버헤드 감소</li></ul></li></ul><h3 id=gogc-옵션>GOGC 옵션<a hidden class=anchor aria-hidden=true href=#gogc-옵션>#</a></h3><p>가비지 컬렉션 대상 백분율 설정<br>이전 수집 후 남은 라이브 데이터에 대한 새로 할당된 데이터의 비율을 조정</p><ul><li><code>GOGC=100</code> : 기본값, 100% 비율<ul><li>힙이 라이브 메모리의 100%만큼 증가하면 GC 트리거</li></ul></li><li><code>GOGC=50</code> : GC를 더 자주 실행<ul><li>메모리 사용량은 줄지만 CPU 사용량 증가</li></ul></li><li><code>GOGC=200</code> : GC를 덜 자주 실행<ul><li>CPU 사용량은 줄지만 메모리 사용량 증가</li></ul></li><li><code>GOGC=off</code> : GC를 사용하지 않음<ul><li>특수한 경우에만 사용 (벤치마크, 테스트 등)</li></ul></li></ul><h3 id=gc-trace-활용>GC Trace 활용<a hidden class=anchor aria-hidden=true href=#gc-trace-활용>#</a></h3><p><code>gctrace</code> 옵션을 통한 가비지 컬렉션 모니터링</p><h4 id=예제-코드>예제 코드<a hidden class=anchor aria-hidden=true href=#예제-코드>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#f92672>package</span> <span style=color:#a6e22e>main</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> (
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;fmt&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;sync&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;time&#34;</span>
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>type</span> <span style=color:#a6e22e>log</span> <span style=color:#66d9ef>struct</span> {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>Info</span> <span style=color:#66d9ef>string</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>Seq</span>  <span style=color:#66d9ef>int</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>wg</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>sync</span>.<span style=color:#a6e22e>WaitGroup</span>{}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>for</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>:=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> &lt; <span style=color:#ae81ff>1000000</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span> {
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>wg</span>.<span style=color:#a6e22e>Add</span>(<span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>go</span> <span style=color:#66d9ef>func</span>() {
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>defer</span> <span style=color:#a6e22e>wg</span>.<span style=color:#a6e22e>Done</span>()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>info</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Sprintf</span>(<span style=color:#e6db74>&#34;test %d&#34;</span>, <span style=color:#a6e22e>i</span>)
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>_</span> = <span style=color:#a6e22e>log</span>{<span style=color:#a6e22e>info</span>, <span style=color:#a6e22e>i</span>}
</span></span><span style=display:flex><span>			<span style=color:#75715e>// fmt.Println(s, t)</span>
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>Sleep</span>(<span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>Millisecond</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>1000</span>)
</span></span><span style=display:flex><span>		}()
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>wg</span>.<span style=color:#a6e22e>Wait</span>()
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h4 id=실행-및-모니터링>실행 및 모니터링<a hidden class=anchor aria-hidden=true href=#실행-및-모니터링>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span><span style=color:#75715e># 프로젝트 초기화</span>
</span></span><span style=display:flex><span>$ go mod init gctest
</span></span><span style=display:flex><span>$ go mod tidy
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># build</span>
</span></span><span style=display:flex><span>$ go build
</span></span></code></pre></div><h5 id=실행-테스트>실행 테스트<a hidden class=anchor aria-hidden=true href=#실행-테스트>#</a></h5><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span><span style=color:#75715e># GODEBUG=gctrace=1 : gctrace 활성화</span>
</span></span><span style=display:flex><span>$ GODEBUG<span style=color:#f92672>=</span>gctrace<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span> ./gctest
</span></span></code></pre></div><h4 id=트레이스-출력-분석>트레이스 출력 분석<a hidden class=anchor aria-hidden=true href=#트레이스-출력-분석>#</a></h4><pre tabindex=0><code>gc 1 @0.010s 9%: 0.058+2.6+0.083 ms clock, 0.46+6.6/2.9/0+0.66 ms cpu, 4-&gt;5-&gt;4 MB, 5 MB goal, 8 P
gc 2 @0.015s 19%: 0.093+4.7+0.17 ms clock, 0.74+14/6.1/0+1.4 ms cpu, 6-&gt;7-&gt;6 MB, 8 MB goal, 8 P
gc 3 @0.027s 25%: 0.15+5.7+0.34 ms clock, 1.2+22/9.0/0+2.7 ms cpu, 10-&gt;13-&gt;11 MB, 13 MB goal, 8 P
gc 4 @0.044s 29%: 0.084+11+0.35 ms clock, 0.67+45/18/0+2.8 ms cpu, 18-&gt;22-&gt;20 MB, 23 MB goal, 8 P
gc 5 @0.076s 31%: 0.24+17+0.19 ms clock, 1.9+66/31/0+1.5 ms cpu, 32-&gt;37-&gt;34 MB, 40 MB goal, 8 P
gc 6 @0.129s 33%: 0.13+26+0.065 ms clock, 1.1+124/50/4.6+0.52 ms cpu, 54-&gt;62-&gt;58 MB, 68 MB goal, 8 P
gc 7 @0.214s 34%: 0.095+40+0.099 ms clock, 0.76+204/79/0.34+0.79 ms cpu, 93-&gt;98-&gt;91 MB, 116 MB goal, 8 P
gc 8 @0.355s 35%: 0.086+66+0.12 ms clock, 0.69+375/132/0+0.99 ms cpu, 152-&gt;158-&gt;144 MB, 182 MB goal, 8 P
gc 9 @0.605s 35%: 0.11+109+0.087 ms clock, 0.88+624/216/0+0.70 ms cpu, 252-&gt;261-&gt;242 MB, 289 MB goal, 8 P
gc 10 @1.033s 35%: 0.077+206+1.0 ms clock, 0.61+1021/397/0.93+8.1 ms cpu, 430-&gt;437-&gt;403 MB, 484 MB goal, 8 P
</code></pre><h4 id=출력-항목-설명>출력 항목 설명:<a hidden class=anchor aria-hidden=true href=#출력-항목-설명>#</a></h4><ul><li><code>gc 1</code>: GC 실행 번호</li><li><code>@0.010s</code>: 프로그램 시작 후 경과 시간</li><li><code>9%</code>: GC에 사용된 CPU 시간 비율</li><li><code>0.058+2.6+0.083 ms</code>: 각 GC 단계별 소요 시간</li><li><code>4->5->4 MB</code>: GC 전후의 힙 크기 변화</li><li><code>5 MB goal</code>: 목표 힙 크기</li><li><code>8 P</code>: 사용된 프로세서 수</li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=https://cdecl.github.io/tags/golang/>Golang</a></li><li><a href=https://cdecl.github.io/tags/gogc/>Gogc</a></li><li><a href=https://cdecl.github.io/tags/tcmalloc/>Tcmalloc</a></li><li><a href=https://cdecl.github.io/tags/tri-color/>Tri-Color</a></li><li><a href=https://cdecl.github.io/tags/gctrace/>Gctrace</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2026 <a href=https://cdecl.github.io/>cdeclog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");if(menu){const e=localStorage.getItem("menu-scroll-position");e&&(menu.scrollLeft=parseInt(e,10)),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}}document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{const e=document.querySelector("html");e.dataset.theme==="dark"?(e.dataset.theme="light",localStorage.setItem("pref-theme","light")):(e.dataset.theme="dark",localStorage.setItem("pref-theme","dark"))})</script></body></html>